<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual RUP - Metodología y Ejemplo Práctico</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plantuml-encoder/1.4.0/plantuml-encoder.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #3972dd 0%, #1d1e81 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        h2 {
            color: #34495e;
            border-left: 5px solid #3498db;
            padding-left: 15px;
            margin-top: 40px;
            font-size: 1.8em;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 25px;
            font-size: 1.3em;
        }
        
        .diagram-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid #e0e6ed;
        }
        
        .diagram-container img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .code-container {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.4;
            border-left: 4px solid #4299e1;
        }
        
        .toggle-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .toggle-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }
        
        /* Estilos para el dropdown de exportación */
        .export-dropdown {
            position: relative;
            display: inline-block;
            margin-left: 10px;
        }
        
        .export-btn {
            background: linear-gradient(45deg, #27ae60, #229954);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .export-btn:hover {
            background: linear-gradient(45deg, #229954, #1e8449);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 200px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            z-index: 1000;
            border: 1px solid #ddd;
            top: 100%;
            left: 0;
            margin-top: 5px;
        }
        
        .dropdown-content a {
            color: #333;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            border-radius: 8px;
            margin: 4px;
            transition: background-color 0.3s ease;
        }
        
        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }
        
        .export-dropdown:hover .dropdown-content {
            display: block;
        }
        
        .description {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }
        
        .phase-header {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            padding: 15px 25px;
            border-radius: 10px 10px 0 0;
            margin: 30px 0 0 0;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .phase-content {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-top: none;
            border-radius: 0 0 10px 10px;
            padding: 20px;
        }

        .uml-element {
            background: #ffffff;
            border: 1px solid #e0e6ed;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .uml-element h5 {
            color: #2d3436;
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.1em;
            border-bottom: 2px solid #74b9ff;
            padding-bottom: 5px;
        }

        .uml-element p {
            margin: 8px 0;
            line-height: 1.4;
        }

        .uml-element .description {
            background: #f1f3f4;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 20px;
        }

        .error {
            background: #ffe6e6;
            color: #d63031;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #d63031;
            margin: 15px 0;
        }

        .info {
            background: #e8f4f8;
            color: #2c3e50;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            margin: 15px 0;
        }

        .copy-btn {
            background: #27ae60 !important;
            margin-left: 10px;
        }

        .copy-btn:hover {
            background: #219a52 !important;
        }

        .theory-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 5px solid #6c757d;
        }

        .theory-content {
            display: none;
            margin-top: 15px;
        }

        .theory-toggle {
            background: linear-gradient(45deg, #6c757d, #495057);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .theory-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        .rup-phase {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #007bff;
        }

        .rup-phase h4 {
            color: #007bff;
            margin-top: 0;
            font-size: 1.2em;
        }

        .rup-phase ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .rup-phase li {
            margin: 5px 0;
        }

        .methodology-nav {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        .nav-btn.active {
            background: rgba(255, 255, 255, 0.4);
            font-weight: bold;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>📚 Manual RUP - Metodología y Ejemplo Práctico</h1>
        <p style="text-align: center; font-size: 1.1em; color: #666; margin-bottom: 40px;">
            Guía completa de la metodología RUP con ejemplo práctico de Sistema de Gestión de Biblioteca
        </p>

        <!-- Navegación de Contenido -->
        <div class="methodology-nav">
            <h2 style="margin: 0; font-size: 1.5em; color:white;">📚 Navegación del Manual</h2>
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showSection('theory', event)">📖 Teoría RUP</button>
                <button class="nav-btn" onclick="showSection('example', event)">🏛️ Ejemplo Práctico</button>
                <button class="nav-btn" onclick="showSection('uml-manual', event)">📐 Manual de UML</button>
                <button class="nav-btn" onclick="showSection('tools', event)">🔧 Herramientas</button>
            </div>
        </div>

        <!-- Sección de Teoría RUP -->
        <div id="theory-section" class="content-section active">
            <div class="theory-section">
                <button class="theory-toggle" onclick="toggleTheory()">
                    📚 Ver/Ocultar Fundamentos de RUP
                </button>
                
                <div id="theory-content" class="theory-content">
                    <h2>🎯 ¿Qué es RUP?</h2>
                    <p>El <strong>Rational Unified Process (RUP)</strong> es una metodología de desarrollo de software iterativo e incremental que proporciona un enfoque disciplinado para asignar tareas y responsabilidades dentro de una organización de desarrollo.</p>
                    
                    <h3>🔑 Características Principales:</h3>
                    <ul>
                        <li><strong>Iterativo e Incremental:</strong> El desarrollo se realiza en ciclos cortos llamados iteraciones</li>
                        <li><strong>Centrado en la Arquitectura:</strong> Enfoque temprano en la definición de la arquitectura del sistema</li>
                        <li><strong>Dirigido por Casos de Uso:</strong> Los casos de uso guían todo el proceso de desarrollo</li>
                        <li><strong>Controlado por Riesgos:</strong> Identificación y mitigación temprana de riesgos</li>
                    </ul>

                    <h2>🚀 Las Cuatro Fases de RUP</h2>
                    
                    <div class="rup-phase">
                        <h4>📋 Fase 1: Inicio (Inception)</h4>
                        <p><strong>Objetivo:</strong> Establecer la visión del proyecto y determinar su viabilidad.</p>
                        <p><strong>Actividades Principales:</strong></p>
                        <ul>
                            <li>Definición del alcance del proyecto</li>
                            <li>Identificación de actores y casos de uso principales</li>
                            <li>Análisis de riesgos iniciales</li>
                            <li>Estimación de recursos y cronograma</li>
                        </ul>
                        <p><strong>Artefactos Clave:</strong> Documento de Visión, Modelo de Casos de Uso inicial, Glosario</p>
                    </div>

                    <div class="rup-phase">
                        <h4>🏗️ Fase 2: Elaboración (Elaboration)</h4>
                        <p><strong>Objetivo:</strong> Definir la arquitectura del sistema y establecer una base sólida para el desarrollo.</p>
                        <p><strong>Actividades Principales:</strong></p>
                        <ul>
                            <li>Captura y análisis detallado de requisitos</li>
                            <li>Diseño de la arquitectura del sistema</li>
                            <li>Prototipado de funcionalidades críticas</li>
                            <li>Planificación detallada de iteraciones</li>
                        </ul>
                        <p><strong>Artefactos Clave:</strong> SRS, Documento de Arquitectura, Casos de Uso detallados</p>
                    </div>

                    <div class="rup-phase">
                        <h4>⚙️ Fase 3: Construcción (Construction)</h4>
                        <p><strong>Objetivo:</strong> Completar el desarrollo del sistema basándose en la arquitectura definida.</p>
                        <p><strong>Actividades Principales:</strong></p>
                        <ul>
                            <li>Implementación iterativa e incremental</li>
                            <li>Pruebas unitarias y de integración</li>
                            <li>Refinamiento de requisitos</li>
                            <li>Gestión de cambios</li>
                        </ul>
                        <p><strong>Artefactos Clave:</strong> Código fuente, Ejecutables, Documentación de usuario</p>
                    </div>

                    <div class="rup-phase">
                        <h4>🚀 Fase 4: Transición (Transition)</h4>
                        <p><strong>Objetivo:</strong> Entregar el producto terminado a los usuarios finales.</p>
                        <p><strong>Actividades Principales:</strong></p>
                        <ul>
                            <li>Pruebas beta con usuarios reales</li>
                            <li>Despliegue en producción</li>
                            <li>Capacitación de usuarios</li>
                            <li>Soporte post-implementación</li>
                        </ul>
                        <p><strong>Artefactos Clave:</strong> Sistema en producción, Documentación final, Material de capacitación</p>
                    </div>

                    <h2>🔄 Los Nueve Flujos de Trabajo</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <div>
                            <h4>🎯 Flujos Principales:</h4>
                            <ul>
                                <li>Modelado del Negocio</li>
                                <li>Requisitos</li>
                                <li>Análisis y Diseño</li>
                                <li>Implementación</li>
                                <li>Pruebas</li>
                                <li>Despliegue</li>
                            </ul>
                        </div>
                        <div>
                            <h4>🛠️ Flujos de Soporte:</h4>
                            <ul>
                                <li>Gestión de Configuración y Cambios</li>
                                <li>Gestión del Proyecto</li>
                                <li>Entorno</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sección del Ejemplo Práctico -->
        <div id="example-section" class="content-section">
            <h1>🏛️ Ejemplo Práctico: Sistema de Gestión de Biblioteca</h1>
            <p style="text-align: center; font-size: 1.1em; color: #666; margin-bottom: 40px;">
                Implementación completa siguiendo la metodología RUP con diagramas PlantUML interactivos
            </p>

        <div class="info">
            <strong>💡 Instrucciones de uso:</strong>
            <ul>
                <li>Haga clic en "Ver/Ocultar Código PlantUML" para ver el código fuente de cada diagrama</li>
                <li>Use "📋 Copiar Código" para copiar el código y usarlo en editores locales</li>
                <li>Use "📥 Exportar" para descargar diagramas como imágenes PNG/SVG</li>
                <li>Los diagramas se cargan automáticamente desde PlantUML.com</li>
                <li>Si hay problemas de conexión, use el código copiado en <a href="https://plantuml.com/es/starting" target="_blank" rel="noopener">PlantUML Local</a> o <a href="https://www.planttext.com/" target="_blank" rel="noopener">PlantText.com</a></li>
                <li><strong>Navegación rápida:</strong> Ctrl+1 (Teoría), Ctrl+2 (Ejemplo), Ctrl+3 (Manual UML), Ctrl+4 (Herramientas)</li>
                <li><button onclick="reloadAllDiagrams()" class="toggle-btn" style="margin: 5px;">🔄 Recargar Todos los Diagramas</button></li>
            </ul>
        </div>

        <!-- Fase 1: Inicio -->
        <div class="phase-header">📋 Fase 1: Inicio - Diagramas de Casos de Uso</div>
        <div class="phase-content">
            <h3>1.1 Diagrama de Casos de Uso General</h3>
            <div class="description">
                Este diagrama muestra todos los actores del sistema y sus casos de uso principales, proporcionando una visión general de la funcionalidad del sistema.
            </div>
            
            <button class="toggle-btn" onclick="toggleCode('usecase-code')">Ver/Ocultar Código PlantUML</button>
            <button class="toggle-btn copy-btn" onclick="copyCode('usecase-code')">📋 Copiar Código</button>
            <div class="export-dropdown">
                <button class="export-btn">📥 Exportar ▼</button>
                <div class="dropdown-content">
                    <a href="#" onclick="exportDiagram('usecase-diagram', 'png', 'diagrama-casos-uso'); return false;">📥 Descargar PNG</a>
                    <a href="#" onclick="exportDiagram('usecase-diagram', 'svg', 'diagrama-casos-uso'); return false;">📄 Descargar SVG</a>
                    <a href="#" onclick="openInPlantText('usecase-code'); return false;">🌐 Abrir en PlantText</a>
                </div>
            </div>
            <div id="usecase-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA
skinparam actor {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
    FontSize 12
}
skinparam usecase {
    BackgroundColor #FFF3E0
    BorderColor #F57C00
    FontSize 11
}
skinparam package {
    BackgroundColor #E8F5E8
    BorderColor #4CAF50
}

left to right direction

actor "👤 Usuario/Estudiante" as Usuario
actor "👨‍💼 Bibliotecario" as Bibliotecario  
actor "🔧 Administrador" as Admin
actor "🔐 Sistema de\nAutenticación" as SistAuth

package "Sistema de Gestión de Biblioteca" {
    usecase "🔍 Buscar Libros" as UC1
    usecase "📝 Solicitar Préstamo" as UC2
    usecase "✅ Registrar Préstamo" as UC3
    usecase "↩️ Procesar Devolución" as UC4
    usecase "📚 Gestionar Inventario" as UC5
    usecase "📊 Generar Reportes" as UC6
    usecase "🔑 Validar Usuario" as UC7
    usecase "📋 Consultar Historial" as UC8
    usecase "⚙️ Configurar Sistema" as UC9
}

Usuario --> UC1
Usuario --> UC2
Usuario --> UC8

Bibliotecario --> UC3
Bibliotecario --> UC4
Bibliotecario --> UC5

Admin --> UC6
Admin --> UC9

UC3 ..> UC7 : <<include>>
UC4 ..> UC7 : <<include>>
UC2 ..> UC7 : <<include>>

SistAuth --> UC7

note right of UC3 : "Requiere validación\nde usuario y\ndisponibilidad del libro"
note bottom of UC6 : "Incluye reportes de:\n• Préstamos por período\n• Libros más solicitados\n• Usuarios morosos"

@enduml
            </div>
            <div class="diagram-container">
                <div id="usecase-diagram" class="loading">Cargando diagrama...</div>
            </div>
        </div>

        <!-- Fase 2: Elaboración -->
        <div class="phase-header">🏗️ Fase 2: Elaboración - Análisis y Diseño</div>
        <div class="phase-content">
            <h3>2.1 Diagrama de Clases del Dominio</h3>
            <div class="description">
                Representa la estructura estática del sistema, mostrando las clases principales, sus atributos, métodos y relaciones.
            </div>
            
            <button class="toggle-btn" onclick="toggleCode('class-code')">Ver/Ocultar Código PlantUML</button>
            <button class="toggle-btn copy-btn" onclick="copyCode('class-code')">📋 Copiar Código</button>
            <div class="export-dropdown">
                <button class="export-btn">📥 Exportar ▼</button>
                <div class="dropdown-content">
                    <a href="#" onclick="exportDiagram('class-diagram', 'png', 'diagrama-clases'); return false;">📥 Descargar PNG</a>
                    <a href="#" onclick="exportDiagram('class-diagram', 'svg', 'diagrama-clases'); return false;">📄 Descargar SVG</a>
                    <a href="#" onclick="openInPlantText('class-code'); return false;">🌐 Abrir en PlantText</a>
                </div>
            </div>
            <div id="class-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam class {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
    FontColor #0D47A1
}
skinparam classFontSize 11

class Usuario {
    -idUsuario: Integer
    -nombre: String
    -apellido: String
    -email: String
    -telefono: String
    -tipo: TipoUsuario
    -fechaRegistro: Date
    -estado: EstadoUsuario
    __
    +validarUsuario(): Boolean
    +obtenerHistorial(): List<Prestamo>
    +actualizarDatos(): void
    +calcularMultasPendientes(): Double
}

class Libro {
    -isbn: String
    -titulo: String
    -autor: String
    -editorial: String
    -categoria: Categoria
    -fechaPublicacion: Date
    -ubicacion: String
    -disponible: Boolean
    -numeroEjemplares: Integer
    __
    +buscar(criterio: String): List<Libro>
    +verificarDisponibilidad(): Boolean
    +reservar(): Boolean
    +actualizarEstado(): void
    +obtenerDetalles(): LibroDetalle
}

class Prestamo {
    -idPrestamo: Integer
    -fechaPrestamo: Date
    -fechaVencimiento: Date
    -fechaDevolucion: Date
    -estado: EstadoPrestamo
    -multaAplicada: Double
    -observaciones: String
    __
    +calcularMulta(): Double
    +renovar(): Boolean
    +procesar(): void
    +verificarVencimiento(): Boolean
    +generarRecibo(): Recibo
}

class Bibliotecario {
    -idEmpleado: Integer
    -nombre: String
    -usuario: String
    -password: String
    -permisos: Set<Permiso>
    -turno: Turno
    __
    +autenticar(): Boolean
    +procesarPrestamo(usuario, libro): Prestamo
    +procesarDevolucion(prestamo): void
    +consultarInventario(): List<Libro>
    +generarReporte(): Reporte
}

class Categoria {
    -idCategoria: Integer
    -nombre: String
    -descripcion: String
    -codigoClasificacion: String
    __
    +obtenerLibros(): List<Libro>
}

class Reserva {
    -idReserva: Integer
    -fechaReserva: Date
    -fechaExpiracion: Date
    -estado: EstadoReserva
    __
    +confirmar(): Prestamo
    +cancelar(): void
    +verificarExpiracion(): Boolean
}

enum TipoUsuario {
    ESTUDIANTE
    PROFESOR
    ADMINISTRATIVO
    EXTERNO
}

enum EstadoPrestamo {
    ACTIVO
    DEVUELTO
    VENCIDO
    RENOVADO
}

' Relaciones
Usuario ||--o{ Prestamo : "realiza"
Usuario ||--o{ Reserva : "hace"
Libro ||--o{ Prestamo : "es prestado en"
Libro }o--|| Categoria : "pertenece a"
Libro ||--o{ Reserva : "es reservado en"
Bibliotecario ||--o{ Prestamo : "procesa"
Prestamo ||--|| Reserva : "puede originarse de"

Usuario::tipo --> TipoUsuario
Prestamo::estado --> EstadoPrestamo

note top of Prestamo : "Clase central que conecta\nUsuarios con Libros"
note right of Bibliotecario : "Actor que ejecuta\nlas operaciones del sistema"

@enduml
            </div>
            <div class="diagram-container">
                <div id="class-diagram" class="loading">Cargando diagrama...</div>
            </div>

            <h3>2.2 Diagrama de Secuencia - Proceso de Préstamo</h3>
            <div class="description">
                Muestra la interacción temporal entre objetos durante el proceso de registro de un préstamo de libro.
            </div>
            
            <button class="toggle-btn" onclick="toggleCode('sequence-code')">Ver/Ocultar Código PlantUML</button>
            <button class="toggle-btn copy-btn" onclick="copyCode('sequence-code')">📋 Copiar Código</button>
            <div class="export-dropdown">
                <button class="export-btn">📥 Exportar ▼</button>
                <div class="dropdown-content">
                    <a href="#" onclick="exportDiagram('sequence-diagram', 'png', 'diagrama-secuencia'); return false;">📥 Descargar PNG</a>
                    <a href="#" onclick="exportDiagram('sequence-diagram', 'svg', 'diagrama-secuencia'); return false;">📄 Descargar SVG</a>
                    <a href="#" onclick="openInPlantText('sequence-code'); return false;">🌐 Abrir en PlantText</a>
                </div>
            </div>
            <div id="sequence-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA
skinparam participant {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
}

participant "👨‍💼 Bibliotecario" as Bib
participant "🖥️ Interfaz Sistema" as UI
participant "🔧 Controlador\nPréstamos" as Ctrl
participant "🔍 Servicio\nValidación" as Valid
participant "💾 Base de Datos" as BD
participant "📧 Servicio\nNotificación" as Notif

activate Bib
Bib -> UI : 1. Escanear código usuario
activate UI

UI -> Ctrl : 2. validarUsuario(codigoUsuario)
activate Ctrl

Ctrl -> Valid : 3. verificarEstado(usuario)
activate Valid

Valid -> BD : 4. consultarUsuario(id)
activate BD
BD --> Valid : 5. datosUsuario
deactivate BD

Valid -> BD : 6. verificarMultasPendientes(id)
activate BD
BD --> Valid : 7. estadoMultas
deactivate BD

Valid --> Ctrl : 8. usuarioValidado
deactivate Valid

Ctrl --> UI : 9. mostrarDatosUsuario()
deactivate Ctrl

UI --> Bib : 10. Información del usuario
deactivate UI

Bib -> UI : 11. Escanear código libro
activate UI

UI -> Ctrl : 12. verificarLibro(isbn)
activate Ctrl

Ctrl -> BD : 13. consultarDisponibilidad(isbn)
activate BD
BD --> Ctrl : 14. estadoLibro
deactivate BD

alt Libro disponible
    Ctrl --> UI : 15. libroDisponible
    deactivate Ctrl
    UI --> Bib : 16. Confirmar préstamo
    deactivate UI
    
    Bib -> UI : 17. Confirmar registro
    activate UI
    
    UI -> Ctrl : 18. registrarPrestamo(usuario, libro)
    activate Ctrl
    
    Ctrl -> BD : 19. insertarPrestamo(datos)
    activate BD
    BD --> Ctrl : 20. prestamoId
    deactivate BD
    
    Ctrl -> BD : 21. actualizarEstadoLibro(isbn, "PRESTADO")
    activate BD
    BD --> Ctrl : 22. confirmación
    deactivate BD
    
    Ctrl -> Notif : 23. enviarNotificacion(usuario, detalles)
    activate Notif
    Notif --> Ctrl : 24. notificacionEnviada
    deactivate Notif
    
    Ctrl --> UI : 25. prestamoRegistrado
    deactivate Ctrl
    
    UI --> Bib : 26. Generar recibo
    deactivate UI

else Libro no disponible
    Ctrl --> UI : 15. libroNoDisponible
    deactivate Ctrl
    UI --> Bib : 16. Mostrar error
    deactivate UI
end

note over Bib, BD
    El proceso incluye validaciones en cada paso
    para garantizar la integridad de los datos
end note

@enduml
            </div>
            <div class="diagram-container">
                <div id="sequence-diagram" class="loading">Cargando diagrama...</div>
            </div>
        </div>

        <!-- Fase 3: Construcción -->
        <div class="phase-header">⚙️ Fase 3: Construcción - Implementación</div>
        <div class="phase-content">
            <h3>3.1 Diagrama de Actividades - Flujo de Préstamo</h3>
            <div class="description">
                Representa el flujo de trabajo completo del proceso de préstamo, incluyendo decisiones y actividades paralelas.
            </div>
            
            <button class="toggle-btn" onclick="toggleCode('activity-code')">Ver/Ocultar Código PlantUML</button>
            <button class="toggle-btn copy-btn" onclick="copyCode('activity-code')">📋 Copiar Código</button>
            <div id="activity-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA
skinparam activity {
    BackgroundColor #E8F5E8
    BorderColor #4CAF50
    FontSize 11
}

|#LightBlue|Bibliotecario|
start
:📱 Escanear código\ndel usuario;

|#LightCyan|Sistema|
:🔍 Validar usuario\nen base de datos;

if (¿Usuario válido?) then (❌ No)
  :⚠️ Mostrar mensaje\nde error;
  stop
else (✅ Sí)
  :📊 Mostrar información\ndel usuario;
endif

|#LightBlue|Bibliotecario|
:📖 Escanear código\ndel libro;

|#LightCyan|Sistema|
:🔍 Verificar disponibilidad\ndel libro;

if (¿Libro disponible?) then (❌ No)
  if (¿Hay reservas?) then (✅ Sí)
    :📝 Mostrar opción\nde reserva;
    if (¿Usuario acepta reserva?) then (✅ Sí)
      :📋 Registrar reserva;
      :📧 Enviar notificación\nde reserva;
      stop
    else (❌ No)
      stop
    endif
  else (❌ No)
    :❌ Mostrar libro\nno disponible;
    stop
  endif
else (✅ Sí)
endif

:🔒 Verificar límite\nde préstamos del usuario;

if (¿Puede prestar más libros?) then (❌ No)
  :⚠️ Mostrar límite\nalcanzado;
  stop
else (✅ Sí)
endif

|#LightBlue|Bibliotecario|
:✅ Confirmar préstamo;

|#LightCyan|Sistema|
fork
  :💾 Registrar préstamo\nen base de datos;
fork again
  :📧 Enviar notificación\nal usuario;
fork again
  :🔄 Actualizar estado\ndel libro;
end fork

:🧾 Generar recibo\nde préstamo;

|#LightBlue|Bibliotecario|
:🖨️ Entregar recibo\nal usuario;

|#LightCyan|Sistema|
:📅 Programar recordatorio\nde vencimiento;

stop

note right
  El sistema maneja múltiples
  validaciones para garantizar
  la integridad del proceso
end note

@enduml
            </div>
            <div class="diagram-container">
                <div id="activity-diagram" class="loading">Cargando diagrama...</div>
            </div>

            <h3>3.2 Diagrama de Estados - Ciclo de Vida del Libro</h3>
            <div class="description">
                Muestra los diferentes estados por los que puede pasar un libro en el sistema y las transiciones entre ellos.
            </div>
            
            <button class="toggle-btn" onclick="toggleCode('state-code')">Ver/Ocultar Código PlantUML</button>
            <button class="toggle-btn copy-btn" onclick="copyCode('state-code')">📋 Copiar Código</button>
            <div id="state-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA
skinparam state {
    BackgroundColor #FFF3E0
    BorderColor #F57C00
    FontSize 11
}

[*] --> Registrado : 📝 Ingreso al sistema

state Registrado {
    state "📚 Disponible" as Disponible
    state "🔒 Reservado" as Reservado
    state "📖 Prestado" as Prestado
    state "🔧 En Mantenimiento" as Mantenimiento
}

Registrado : 📋 Libro ingresado al catálogo
Registrado : 🔍 Datos verificados
Registrado : 📍 Ubicación asignada

Disponible --> Reservado : 📝 Usuario hace reserva
Disponible --> Prestado : ✅ Préstamo directo
Disponible --> Mantenimiento : 🔧 Requiere reparación

Reservado --> Prestado : ✅ Usuario confirma préstamo
Reservado --> Disponible : ❌ Reserva expira/cancela
Reservado --> Mantenimiento : 🔧 Requiere reparación

Prestado --> Disponible : ↩️ Devolución normal
Prestado --> Mantenimiento : 🔧 Daño reportado
Prestado --> Perdido : ❌ No devuelto (90+ días)

Mantenimiento --> Disponible : ✅ Reparación completada
Mantenimiento --> Baja : ❌ Irreparable

state "📉 Perdido" as Perdido {
    Perdido : ⚠️ Libro extraviado
    Perdido : 💰 Multa aplicada
    Perdido : 📧 Usuario notificado
}

state "🗑️ Dado de Baja" as Baja {
    Baja : ❌ Libro retirado del catálogo
    Baja : 📋 Registro histórico mantenido
}

Perdido --> Disponible : 🔍 Libro encontrado
Perdido --> Baja : ❌ Declarado pérdida total

Baja --> [*] : 🗂️ Archivo histórico

note top of Disponible : "Estado principal\ndel libro"
note right of Prestado : "Incluye fecha\nde vencimiento"
note bottom of Mantenimiento : "Estado temporal\npara reparaciones"

@enduml
            </div>
            <div class="diagram-container">
                <div id="state-diagram" class="loading">Cargando diagrama...</div>
            </div>
        </div>

        <!-- Fase 4: Transición -->
        <div class="phase-header">🚀 Fase 4: Transición - Despliegue</div>
        <div class="phase-content">
            <h3>4.1 Diagrama de Componentes</h3>
            <div class="description">
                Muestra la organización y dependencias entre los componentes del sistema, útil para el despliegue.
            </div>
            
            <button class="toggle-btn" onclick="toggleCode('component-code')">Ver/Ocultar Código PlantUML</button>
            <button class="toggle-btn copy-btn" onclick="copyCode('component-code')">📋 Copiar Código</button>
            <div id="component-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA
skinparam component {
    BackgroundColor #E8F5E8
    BorderColor #4CAF50
    FontSize 10
}

package "🖥️ Capa de Presentación" {
    [🌐 Interfaz Web] as WebUI
    [📱 App Móvil] as MobileApp
    [🖨️ Módulo Impresión] as PrintModule
}

package "⚙️ Capa de Servicios" {
    [🔧 Controlador Préstamos] as LoanController
    [👤 Controlador Usuarios] as UserController
    [📚 Controlador Libros] as BookController
    [📊 Controlador Reportes] as ReportController
}

package "💼 Capa de Negocio" {
    [🔍 Servicio Validación] as ValidationService
    [📧 Servicio Notificación] as NotificationService
    [💰 Servicio Multas] as FineService
    [📋 Servicio Reservas] as ReservationService
}

package "💾 Capa de Datos" {
    [🗄️ Repositorio Usuarios] as UserRepo
    [🗄️ Repositorio Libros] as BookRepo
    [🗄️ Repositorio Préstamos] as LoanRepo
    [🗄️ Repositorio Reportes] as ReportRepo
}

database "🗃️ Base de Datos\nMySQL" as DB

cloud "☁️ Servicios Externos" {
    [📧 Servidor Email] as EmailServer
    [🔐 Servicio Autenticación] as AuthService
    [📊 Analytics] as Analytics
}

' Conexiones Capa Presentación -> Servicios
WebUI --> LoanController
WebUI --> UserController
WebUI --> BookController
WebUI --> ReportController

MobileApp --> LoanController
MobileApp --> UserController
MobileApp --> BookController

PrintModule --> LoanController
PrintModule --> ReportController

' Conexiones Servicios -> Negocio
LoanController --> ValidationService
LoanController --> NotificationService
LoanController --> FineService

UserController --> ValidationService
UserController --> NotificationService

BookController --> ValidationService
BookController --> ReservationService

ReportController --> FineService

' Conexiones Negocio -> Datos
ValidationService --> UserRepo
ValidationService --> BookRepo
ValidationService --> LoanRepo

NotificationService --> UserRepo

FineService --> LoanRepo
FineService --> UserRepo

ReservationService --> BookRepo
ReservationService --> LoanRepo

' Conexiones Datos -> BD
UserRepo --> DB
BookRepo --> DB
LoanRepo --> DB
ReportRepo --> DB

' Servicios Externos
NotificationService --> EmailServer
ValidationService --> AuthService
ReportController --> Analytics

note top of WebUI : "React/Angular\nInterfaz principal"
note top of MobileApp : "Flutter/React Native\nAcceso móvil"
note right of DB : "Almacenamiento\npersistente de datos"
note bottom of EmailServer : "Notificaciones\nautomáticas"

@enduml
            </div>
            <div class="diagram-container">
                <div id="component-diagram" class="loading">Cargando diagrama...</div>
            </div>

            <h3>4.2 Diagrama de Despliegue</h3>
            <div class="description">
                Representa la arquitectura física del sistema, mostrando cómo se distribuyen los componentes en el hardware.
            </div>
            
            <button class="toggle-btn" onclick="toggleCode('deployment-code')">Ver/Ocultar Código PlantUML</button>
            <button class="toggle-btn copy-btn" onclick="copyCode('deployment-code')">📋 Copiar Código</button>
            <div id="deployment-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA
skinparam node {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
    FontSize 10
}

' ==== Servidores principales ====
node "🖥️ Servidor Web\n(Nginx)" as WebServer {
    artifact "🌐 Aplicación Web\n(React)" as WebApp
    artifact "📱 API REST\n(Node.js/Express)" as API
}

node "⚙️ Servidor de Aplicaciones\n(Docker Container)" as AppServer {
    artifact "🔧 Servicios de Negocio\n(Java Spring Boot)" as BusinessServices
    artifact "📊 Módulo Reportes\n(Jasper Reports)" as ReportModule
}

node "💾 Servidor Base de Datos\n(MySQL 8.0)" as DBServer {
    database "🗃️ BD Biblioteca\n(biblioteca_db)" as MainDB
    database "📋 BD Logs\n(logs_db)" as LogDB
}

node "☁️ Servidor Cache\n(Redis)" as CacheServer {
    artifact "⚡ Cache Consultas" as QueryCache
    artifact "🔑 Sesiones Usuario" as SessionCache
}

node "📧 Servidor Email\n(Postfix/SendGrid)" as EmailServer {
    artifact "📮 Cola de Emails\n(RabbitMQ)" as EmailQueue
    artifact "📨 Templates Email" as EmailTemplates
}

' ==== Estaciones y dispositivos ====
node "🖨️ Estación Bibliotecario\n(Windows PC)" as LibrarianStation {
    artifact "🖥️ Cliente Escritorio\n(Electron)" as DesktopClient
    artifact "🖨️ Driver Impresora\n(Zebra/Brother)" as PrinterDriver
}

node "📱 Dispositivos Móviles\n(Android/iOS)" as MobileStation {
    artifact "📱 App Móvil\n(Flutter)" as MobileApp
}

' ==== Internet ====
cloud "🌐 Internet" as Internet

' ==== Conexiones de red ====
LibrarianStation ..> Internet : HTTPS/443
MobileStation ..> Internet : HTTPS/443
Internet ..> WebServer : Load Balancer

WebServer --> AppServer : HTTP/8080
AppServer --> DBServer : MySQL/3306
AppServer --> CacheServer : Redis/6379
AppServer --> EmailServer : SMTP/587

WebServer --> CacheServer : Redis/6379

' ==== Notas sobre puertos ====
note right of WebServer
    Puertos abiertos: 80/443 (HTTP/HTTPS)
end note

note right of AppServer
    Puerto 8080 (HTTP)
end note

note right of DBServer
    Puerto 3306 (MySQL)
end note

note bottom of CacheServer
    Puerto 6379 (Redis)
end note

note right of EmailServer
    Puerto 587 (SMTP)
end note

' ==== Notas adicionales ====
note top of WebServer
    Balanceador de carga con
    múltiples instancias para
    alta disponibilidad.
end note

note right of DBServer
    Replicación maestro-esclavo
    para backup y recuperación.
end note

note bottom of CacheServer
    Mejora rendimiento de
    consultas frecuentes.
end note

@enduml

            </div>
            <div class="diagram-container">
                <div id="deployment-diagram" class="loading">Cargando diagrama...</div>
            </div>
        </div>

        <!-- Diagramas Adicionales -->
        <div class="phase-header">📊 Diagramas Complementarios</div>
        <div class="phase-content">
            <h3>5.1 Diagrama de Casos de Uso Detallado - Gestión de Préstamos</h3>
            <div class="description">
                Detalle específico de los casos de uso relacionados con la gestión de préstamos, incluyendo extensiones y inclusiones.
            </div>
            
            <button class="toggle-btn" onclick="toggleCode('detailed-usecase-code')">Ver/Ocultar Código PlantUML</button>
            <button class="toggle-btn copy-btn" onclick="copyCode('detailed-usecase-code')">📋 Copiar Código</button>
            <div id="detailed-usecase-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA
skinparam actor {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
}
skinparam usecase {
    BackgroundColor #FFF3E0
    BorderColor #F57C00
    FontSize 10
}

left to right direction

actor "👤 Usuario" as User
actor "👨‍💼 Bibliotecario" as Librarian
actor "🔐 Sistema Auth" as Auth

package "Gestión de Préstamos" {
    usecase "📝 Solicitar Préstamo" as UC_Request
    usecase "✅ Aprobar Préstamo" as UC_Approve
    usecase "🔍 Verificar Disponibilidad" as UC_CheckAvail
    usecase "🔑 Validar Usuario" as UC_ValidateUser
    usecase "📋 Registrar Préstamo" as UC_Register
    usecase "🧾 Generar Recibo" as UC_Receipt
    usecase "↩️ Procesar Devolución" as UC_Return
    usecase "💰 Calcular Multa" as UC_Fine
    usecase "🔄 Renovar Préstamo" as UC_Renew
    usecase "📧 Enviar Notificación" as UC_Notify
    usecase "⏰ Programar Recordatorio" as UC_Reminder
}

package "Gestión de Reservas" {
    usecase "📅 Crear Reserva" as UC_CreateRes
    usecase "✅ Confirmar Reserva" as UC_ConfirmRes
    usecase "❌ Cancelar Reserva" as UC_CancelRes
}

' Relaciones principales
User --> UC_Request
Librarian --> UC_Approve
Librarian --> UC_Register
Librarian --> UC_Return

' Relaciones include
UC_Request ..> UC_ValidateUser : <<include>>
UC_Approve ..> UC_CheckAvail : <<include>>
UC_Register ..> UC_Receipt : <<include>>
UC_Register ..> UC_Notify : <<include>>
UC_Register ..> UC_Reminder : <<include>>
UC_Return ..> UC_Fine : <<include>>

' Relaciones extend
UC_CreateRes ..> UC_Request : <<extend>>
UC_Renew ..> UC_Request : <<extend>>

' Relaciones con sistema externo
Auth --> UC_ValidateUser

' Flujos de reserva
User --> UC_CreateRes
Librarian --> UC_ConfirmRes
User --> UC_CancelRes

note right of UC_Request
    Punto de entrada principal
    para usuarios del sistema
end note

note bottom of UC_Fine
    Se calcula automáticamente
    según días de retraso
end note

note left of UC_CreateRes
    Se activa cuando el libro
    no está disponible
end note

@enduml
            </div>
            <div class="diagram-container">
                <div id="detailed-usecase-diagram" class="loading">Cargando diagrama...</div>
            </div>

            <h3>5.2 Diagrama de Colaboración - Proceso de Devolución</h3>
            <div class="description">
                Muestra cómo los objetos colaboran entre sí durante el proceso de devolución de un libro.
            </div>
            
            <button class="toggle-btn" onclick="toggleCode('collaboration-code')">Ver/Ocultar Código PlantUML</button>
            <button class="toggle-btn copy-btn" onclick="copyCode('collaboration-code')">📋 Copiar Código</button>
            <div id="collaboration-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA
skinparam object {
    BackgroundColor #E8F5E8
    BorderColor #4CAF50
}

object "👨‍💼 bibliotecario:Bibliotecario" as bib
object "🖥️ ui:InterfazSistema" as ui  
object "🔧 ctrl:ControladorPrestamo" as ctrl
object "💾 prestamoRepo:PrestamoRepository" as repo
object "💰 multa:ServicioMulta" as multa
object "📧 notif:ServicioNotificacion" as notif
object "📊 audit:ServicioAuditoria" as audit

bib -> ui : 1. escanearCodigoLibro()
ui -> ctrl : 2. procesarDevolucion(isbn)
ctrl -> repo : 3. buscarPrestamoPorISBN(isbn)
repo -> ctrl : 4. prestamo
ctrl -> multa : 5. calcularMulta(prestamo)
multa -> ctrl : 6. montoMulta
ctrl -> repo : 7. actualizarEstadoPrestamo()
ctrl -> notif : 8. enviarConfirmacion(usuario)
ctrl -> audit : 9. registrarDevolucion()
ctrl -> ui : 10. mostrarResumenDevolucion()
ui -> bib : 11. imprimirComprobante()

note top of ctrl
    Orquesta todo el proceso
    de devolución
end note

note right of multa
    Calcula multas según
    política de la biblioteca
end note

note bottom of audit
    Mantiene registro de
    todas las operaciones
end note

@enduml
            </div>
            <div class="diagram-container">
                <div id="collaboration-diagram" class="loading">Cargando diagrama...</div>
            </div>

            <h3>5.3 Diagrama de Paquetes - Arquitectura del Sistema</h3>
            <div class="description">
                Organiza las clases del sistema en paquetes lógicos, mostrando las dependencias entre ellos.
            </div>
            
            <button class="toggle-btn" onclick="toggleCode('package-code')">Ver/Ocultar Código PlantUML</button>
            <button class="toggle-btn copy-btn" onclick="copyCode('package-code')">📋 Copiar Código</button>
            <div id="package-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA
skinparam package {
    BackgroundColor #E8F5E8
    BorderColor #4CAF50
    FontSize 12
}

package "🖥️ com.biblioteca.presentacion" {
    package "web" {
        class UsuarioController
        class LibroController 
        class PrestamoController
    }
    
    package "mobile" {
        class MobileAPI
        class AuthController
    }
    
    package "desktop" {
        class BibliotecarioUI
        class ReportesUI
    }
}

package "💼 com.biblioteca.negocio" {
    package "servicios" {
        class PrestamoService
        class UsuarioService
        class LibroService
        class NotificacionService
    }
    
    package "validadores" {
        class ValidadorUsuario
        class ValidadorPrestamo
        class ValidadorLibro
    }
    
    package "calculadores" {
        class CalculadorMulta
        class CalculadorFechas
    }
}

package "💾 com.biblioteca.datos" {
    package "repositorios" {
        interface PrestamoRepository
        interface UsuarioRepository
        interface LibroRepository
    }
    
    package "implementaciones" {
        class PrestamoRepositoryImpl
        class UsuarioRepositoryImpl
        class LibroRepositoryImpl
    }
    
    package "entidades" {
        class Prestamo
        class Usuario
        class Libro
    }
}

package "🔧 com.biblioteca.infraestructura" {
    package "configuracion" {
        class DatabaseConfig
        class SecurityConfig
        class EmailConfig
    }
    
    package "utilidades" {
        class DateUtils
        class StringUtils
        class EmailUtils
    }
    
    package "excepciones" {
        class BibliotecaException
        class ValidationException
        class DataException
    }
}

package "🔐 com.biblioteca.seguridad" {
    package "auth" {
        class JWTProvider
        class UserDetailsService
        class AuthenticationFilter
    }
    
    package "encriptacion" {
        class PasswordEncoder
        class DataEncryption
    }
}

' Dependencias entre paquetes
com.biblioteca.presentacion ..> com.biblioteca.negocio : uses
com.biblioteca.negocio ..> com.biblioteca.datos : uses
com.biblioteca.negocio ..> com.biblioteca.infraestructura : uses
com.biblioteca.presentacion ..> com.biblioteca.seguridad : uses
com.biblioteca.datos ..> com.biblioteca.infraestructura : uses

note top of com.biblioteca.presentacion
    Capa de interfaces de usuario
    (Web, Mobile, Desktop)
end note

note right of com.biblioteca.negocio
    Lógica de negocio y
    reglas del dominio
end note

note bottom of com.biblioteca.datos
    Acceso a datos y
    persistencia
end note

note left of com.biblioteca.infraestructura
    Servicios transversales
    y configuraciones
end note

@enduml
            </div>
            <div class="diagram-container">
                <div id="package-diagram" class="loading">Cargando diagrama...</div>
            </div>
        </div>

        <div class="phase-header">📋 Resumen de Aplicación de RUP</div>
        <div class="phase-content">
            <div class="description">
                <h3>🎯 Aplicación Práctica de los Diagramas en RUP</h3>
                <p><strong>Fase de Inicio:</strong></p>
                <ul>
                    <li>📊 <strong>Diagrama de Casos de Uso:</strong> Define el alcance y funcionalidades principales</li>
                    <li>👥 <strong>Identificación de Actores:</strong> Establece quiénes interactúan con el sistema</li>
                </ul>
                
                <p><strong>Fase de Elaboración:</strong></p>
                <ul>
                    <li>🏗️ <strong>Diagrama de Clases:</strong> Define la estructura del sistema y relaciones entre entidades</li>
                    <li>🔄 <strong>Diagramas de Secuencia:</strong> Detallan las interacciones temporales entre objetos</li>
                    <li>📦 <strong>Diagrama de Paquetes:</strong> Organiza la arquitectura en módulos lógicos</li>
                </ul>
                
                <p><strong>Fase de Construcción:</strong></p>
                <ul>
                    <li>⚡ <strong>Diagramas de Actividades:</strong> Guían la implementación de procesos de negocio</li>
                    <li>🔄 <strong>Diagramas de Estados:</strong> Definen el comportamiento de objetos complejos</li>
                    <li>🤝 <strong>Diagramas de Colaboración:</strong> Muestran cómo los objetos trabajan juntos</li>
                </ul>
                
                <p><strong>Fase de Transición:</strong></p>
                <ul>
                    <li>🧩 <strong>Diagrama de Componentes:</strong> Facilita el empaquetado y distribución</li>
                    <li>🌐 <strong>Diagrama de Despliegue:</strong> Guía la instalación en el ambiente de producción</li>
                </ul>
            </div>
        </div>
        </div> <!-- Fin de example-section -->

        <!-- Sección Manual de UML -->
        <div id="uml-manual-section" class="content-section">
            <h1>📐 Manual Práctico de UML para Analistas de Sistemas</h1>
            
            <div class="theory-section">
                <div class="info">
                    <strong>💡 Sobre este Manual:</strong>
                    <p>Manual completo de UML con ejemplos prácticos, diagramas interactivos y mejores prácticas para analistas de sistemas.</p>
                </div>

                <h2>📋 Tabla de Contenidos</h2>
                <div class="phase-content">
                    <ul>
                        <li><a href="#uml-intro">Introducción a UML</a></li>
                        <li><a href="#uml-concepts">Conceptos Fundamentales</a></li>
                        <li><a href="#structure-diagrams">Diagramas de Estructura</a></li>
                        <li><a href="#behavior-diagrams">Diagramas de Comportamiento</a></li>
                        <li><a href="#interaction-diagrams">Diagramas de Interacción</a></li>
                        <li><a href="#plantuml-tool">PlantUML: Herramienta Práctica</a></li>
                        <li><a href="#analysis-methodology">Metodología de Análisis con UML</a></li>
                        <li><a href="#best-practices">Buenas Prácticas</a></li>
                        <li><a href="#case-studies">Casos de Estudio</a></li>
                        <li><a href="#design-patterns">Patrones de Diseño en UML</a></li>
                        <li><a href="#advanced-study">Técnicas Avanzadas</a></li>
                        <li><a href="#code-generation">Generación de Código</a></li>
                        <li><a href="#methodology-section">Metodología RUP</a></li>
                        <li><a href="#conclusions-section">Conclusiones</a></li>
                    </ul>
                </div>

                <div id="uml-intro" class="phase-header">🎯 Introducción a UML</div>
                <div class="phase-content">
                    <h3>¿Qué es UML?</h3>
                    <div class="description">
                        <strong>UML (Unified Modeling Language)</strong> es un lenguaje de modelado visual estándar utilizado para especificar, construir, visualizar y documentar sistemas de software. Desarrollado por Grady Booch, James Rumbaugh e Ivar Jacobson en los años 90, UML se ha convertido en el estándar de facto para el modelado orientado a objetos.
                    </div>

                    <h4>Objetivos de UML</h4>
                    <ul>
                        <li><strong>Visualización:</strong> Proporcionar un lenguaje visual para expresar modelos</li>
                        <li><strong>Especificación:</strong> Crear modelos precisos, no ambiguos y completos</li>
                        <li><strong>Construcción:</strong> Permitir la generación de código a partir de modelos</li>
                        <li><strong>Documentación:</strong> Facilitar la comunicación entre equipos de desarrollo</li>
                    </ul>

                    <h4>Versiones de UML</h4>
                    <ul>
                        <li><strong>UML 1.x:</strong> Versiones iniciales (1997-2005)</li>
                        <li><strong>UML 2.x:</strong> Versión actual con importantes mejoras estructurales</li>
                        <li><strong>UML 2.5.1:</strong> Versión más reciente (2017)</li>
                    </ul>
                </div>

                <div id="uml-concepts" class="phase-header">🧩 Conceptos Fundamentales</div>
                <div class="phase-content">
                    <h3>Elementos Básicos de UML</h3>
                    
                    <h4>1. Elementos Estructurales</h4>
                    <div class="description">
                        <p>Los elementos estructurales son los sustantivos del modelo UML. Representan las partes estáticas del modelo.</p>
                    </div>

                    <div class="uml-element">
                        <h5>🏛️ Clases</h5>
                        <p><strong>Descripción:</strong> Representan objetos con atributos y operaciones similares</p>
                        <p><strong>Representación visual:</strong> Rectángulo dividido en tres compartimentos</p>
                        
                        <button class="toggle-btn" onclick="toggleCode('structural-class-example')">Ver Ejemplo PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('structural-class-example')">📋 Copiar</button>
                        
                        <div id="structural-class-example" class="code-container" style="display: none;">
@startuml ElementosEstructurales_Clases
!theme cerulean-outline

class Persona {
    - nombre: String
    - edad: int
    # telefono: String
    + email: String
    
    + getNombre(): String
    + setEdad(edad: int): void
    # validarTelefono(): boolean
    - calcularHash(): String
}

note right of Persona
  Compartimentos:
  1. Nombre de la clase
  2. Atributos (con visibilidad)
  3. Operaciones/Métodos
  
  Visibilidad:
  + público
  - privado
  # protegido
  ~ paquete
end note
@enduml
                        </div>
                        <div id="structural-class-diagram">Cargando ejemplo...</div>
                    </div>

                    <div class="uml-element">
                        <h5>🔌 Interfaces</h5>
                        <p><strong>Descripción:</strong> Contrato que especifica operaciones sin implementación</p>
                        <p><strong>Representación visual:</strong> Rectángulo con estereotipo &lt;&lt;interface&gt;&gt; o símbolo de círculo</p>
                        
                        <button class="toggle-btn" onclick="toggleCode('structural-interface-example')">Ver Ejemplo PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('structural-interface-example')">📋 Copiar</button>
                        
                        <div id="structural-interface-example" class="code-container" style="display: none;">
@startuml ElementosEstructurales_Interfaces
!theme cerulean-outline

interface Volador {
    + volar(): void
    + aterrizar(): void
    + obtenerAltitudMaxima(): int
}

interface Reproducible {
    + reproducir(): void
    + pausar(): void
    + detener(): void
}

class Avion {
    - altitud: int
    - velocidad: double
    + volar(): void
    + aterrizar(): void
    + obtenerAltitudMaxima(): int
}

class Drone {
    - bateria: int
    - camara: boolean
    + volar(): void
    + aterrizar(): void
    + obtenerAltitudMaxima(): int
}

' Implementación de interfaces
Volador <|.. Avion
Volador <|.. Drone

note top of Volador
  Interface define
  el contrato de
  comportamiento
end note
@enduml
                        </div>
                        <div id="structural-interface-diagram">Cargando ejemplo...</div>
                    </div>

                    <div class="uml-element">
                        <h5>📦 Componentes</h5>
                        <p><strong>Descripción:</strong> Partes físicas y reemplazables del sistema</p>
                        <p><strong>Representación visual:</strong> Rectángulo con icono de componente o estereotipo &lt;&lt;component&gt;&gt;</p>
                        
                        <button class="toggle-btn" onclick="toggleCode('structural-component-example')">Ver Ejemplo PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('structural-component-example')">📋 Copiar</button>
                        
                        <div id="structural-component-example" class="code-container" style="display: none;">
@startuml ElementosEstructurales_Componentes
!theme cerulean-outline

component [UserInterface] as UI
component [BusinessLogic] as BL 
component [DataAccess] as DA
database [Database] as DB

note right of UI
  Los componentes representan
  partes modulares del sistema
  que pueden ser reemplazadas
  independientemente
end note

UI --> BL : usa
BL --> DA : accede
DA --> DB : consulta

interface IUserService
interface IDataRepository

BL -( IUserService
DA -( IDataRepository
@enduml
                        </div>
                        <div id="structural-component-diagram">Cargando ejemplo...</div>
                    </div>

                    <div class="uml-element">
                        <h5>🖥️ Nodos</h5>
                        <p><strong>Descripción:</strong> Elementos físicos que existen en tiempo de ejecución</p>
                        <p><strong>Representación visual:</strong> Cubo tridimensional o rectángulo con estereotipo &lt;&lt;device&gt;&gt;</p>
                        
                        <button class="toggle-btn" onclick="toggleCode('structural-node-example')">Ver Ejemplo PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('structural-node-example')">📋 Copiar</button>
                        
                        <div id="structural-node-example" class="code-container" style="display: none;">
@startuml ElementosEstructurales_Nodos
!theme cerulean-outline

node "Servidor Web" as web {
  component [Apache]
  component [PHP Engine]
}

node "Servidor Base Datos" as db {
  database [MySQL]
  database [Redis Cache]
}

node "Cliente PC" as pc {
  component [Navegador]
}

node "Dispositivo Móvil" as mobile {
  component [App Mobile]
}

cloud "Internet" as internet

note top of web
  Los nodos representan
  recursos computacionales
  físicos donde se ejecutan
  los componentes
end note

pc --> internet : HTTP/HTTPS
mobile --> internet : HTTP/HTTPS
internet --> web : requests
web --> db : SQL/TCP
@enduml
                        </div>
                        <div id="structural-node-diagram">Cargando ejemplo...</div>
                    </div>

                    <h4>2. Elementos de Comportamiento</h4>
                    <div class="description">
                        <p>Los elementos de comportamiento son los verbos del modelo UML. Representan las partes dinámicas del modelo.</p>
                    </div>

                    <div class="uml-element">
                        <h5>💬 Interacciones</h5>
                        <p><strong>Descripción:</strong> Comportamientos que comprenden mensajes entre objetos</p>
                        <p><strong>Representación visual:</strong> Marcos de interacción con líneas de vida y mensajes</p>
                        
                        <button class="toggle-btn" onclick="toggleCode('behavior-interaction-example')">Ver Ejemplo PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('behavior-interaction-example')">📋 Copiar</button>
                        
                        <div id="behavior-interaction-example" class="code-container" style="display: none;">
@startuml ElementosComportamiento_Interacciones
!theme cerulean-outline

participant "Cliente" as C
participant "Servidor" as S
participant "Base Datos" as DB

note over C, DB
  Las interacciones muestran
  el intercambio de mensajes
  entre objetos a lo largo del tiempo
end note

C -> S: solicitar datos
activate S
S -> DB: consultar información
activate DB
DB --> S: resultado consulta
deactivate DB
S --> C: respuesta datos
deactivate S

note right of S
  Los mensajes pueden ser:
  • Síncronos (→)
  • Asíncronos (--→)
  • De retorno (←-)
  • Autollamadas (↻)
end note
@enduml
                        </div>
                        <div id="behavior-interaction-diagram">Cargando ejemplo...</div>
                    </div>

                    <div class="uml-element">
                        <h5>🔄 Máquinas de Estado</h5>
                        <p><strong>Descripción:</strong> Comportamiento que especifica secuencias de estados</p>
                        <p><strong>Representación visual:</strong> Estados como rectángulos redondeados conectados por transiciones</p>
                        
                        <button class="toggle-btn" onclick="toggleCode('behavior-state-example')">Ver Ejemplo PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('behavior-state-example')">📋 Copiar</button>
                        
                        <div id="behavior-state-example" class="code-container" style="display: none;">
@startuml ElementosComportamiento_Estados
!theme cerulean-outline

[*] --> Apagado : encender()

state Apagado {
  state "Sin energía" as off
  [*] --> off
}

state Encendido {
  [*] --> Inactivo
  Inactivo --> Trabajando : iniciar_tarea()
  Trabajando --> Inactivo : completar_tarea()
  Trabajando --> Error : fallo()
  Error --> Inactivo : reiniciar()
}

Apagado --> Encendido : power_on()
Encendido --> Apagado : power_off()

note top of Encendido
  Los estados representan
  condiciones o situaciones
  en la vida de un objeto
end note

note bottom of Apagado
  Las transiciones muestran
  el cambio de un estado
  a otro debido a eventos
end note
@enduml
                        </div>
                        <div id="behavior-state-diagram">Cargando ejemplo...</div>
                    </div>

                    <h4>3. Elementos de Agrupación</h4>
                    <div class="description">
                        <p>Los elementos de agrupación organizan y estructuran los modelos UML.</p>
                    </div>

                    <div class="uml-element">
                        <h5>📂 Paquetes</h5>
                        <p><strong>Descripción:</strong> Mecanismo organizacional para agrupar elementos</p>
                        <p><strong>Representación visual:</strong> Carpeta con pestaña conteniendo elementos relacionados</p>
                        
                        <button class="toggle-btn" onclick="toggleCode('grouping-package-example')">Ver Ejemplo PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('grouping-package-example')">📋 Copiar</button>
                        
                        <div id="grouping-package-example" class="code-container" style="display: none;">
@startuml ElementosAgrupacion_Paquetes
!theme cerulean-outline

package "Capa de Presentación" {
  class ControladorWeb
  class VistaHTML
  interface IControlador
}

package "Capa de Negocio" {
  class ServicioUsuario
  class ReglasNegocio
  interface IServicio
}

package "Capa de Datos" {
  class RepositorioUsuario
  class ConexionBD
  interface IRepositorio
}

note top of "Capa de Presentación"
  Los paquetes agrupan
  elementos relacionados
  y definen espacios de nombres
end note

"Capa de Presentación" ..> "Capa de Negocio" : usa
"Capa de Negocio" ..> "Capa de Datos" : usa

note bottom of "Capa de Datos"
  Las dependencias entre paquetes
  muestran relaciones de uso
  a nivel arquitectónico
end note
@enduml
                        </div>
                        <div id="grouping-package-diagram">Cargando ejemplo...</div>
                    </div>

                    <h4>4. Elementos de Anotación</h4>
                    <div class="description">
                        <p>Los elementos de anotación agregan información explicativa al modelo.</p>
                    </div>

                    <div class="uml-element">
                        <h5>📝 Notas</h5>
                        <p><strong>Descripción:</strong> Comentarios explicativos adjuntos a elementos</p>
                        <p><strong>Representación visual:</strong> Rectángulo con esquina doblada, conectado con línea punteada</p>
                        
                        <button class="toggle-btn" onclick="toggleCode('annotation-note-example')">Ver Ejemplo PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('annotation-note-example')">📋 Copiar</button>
                        
                        <div id="annotation-note-example" class="code-container" style="display: none;">
@startuml ElementosAnotacion_Notas
!theme cerulean-outline

class Usuario {
  - nombre: String
  - email: String
  - password: String
  + validarEmail(): boolean
}

note right of Usuario
  Esta clase implementa
  el patrón Active Record
  
  **Restricciones:**
  • Email debe ser único
  • Password mínimo 8 caracteres
  • Nombre no puede ser vacío
end note

' Nota sobre el método validarEmail usando flecha
note as N2
  Valida formato de email
  usando expresiones regulares
end note
Usuario ..> N2 : validarEmail()

note as N1
  **Patrón de Diseño:**
  Este modelo utiliza el patrón
  Repository para la persistencia
  
  **Versión:** 2.1
  **Autor:** Equipo de Desarrollo
  **Fecha:** Agosto 2025
end note

N1 .. Usuario

note bottom of Usuario
  Las notas pueden contener:
  • Texto simple
  • **Texto en negrita**
  • //Texto en cursiva//
  • Listas con bullets
  • Enlaces y referencias
end note
@enduml

                        </div>
                        <div id="annotation-note-diagram">Cargando ejemplo...</div>
                    </div>

                    <h3>Relaciones en UML</h3>
                    <div class="description">
                        <p>Las relaciones conectan elementos UML y definen cómo interactúan entre sí. Existen cuatro tipos principales de relaciones.</p>
                    </div>

                    <div class="uml-element">
                        <h5>↗️ Dependencia</h5>
                        <p><strong>Descripción:</strong> Relación donde un elemento depende de otro (relación "usa")</p>
                        <p><strong>Representación visual:</strong> Línea punteada con flecha (--&gt;)</p>
                        <p><strong>Ejemplo código:</strong> <code>Cliente -.-> Servicio : usa</code></p>
                        
                        <button class="toggle-btn" onclick="toggleCode('relation-dependency-example')">Ver Ejemplo PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('relation-dependency-example')">📋 Copiar</button>
                        
                        <div id="relation-dependency-example" class="code-container" style="display: none;">
@startuml Relaciones_Dependencia
!theme cerulean-outline

class Cliente {
  + realizarPedido(): void
  + calcularDescuento(): void
}

class Calculadora {
  + calcular(operacion: String): double
  + validarNumero(num: String): boolean
}

class EmailService {
  + enviarEmail(destinatario: String): void
  + validarEmail(email: String): boolean
}

class LoggerUtil {
  + log(mensaje: String): void
  + logError(error: Exception): void
}

' Dependencias - líneas punteadas con flechas
Cliente -.-> Calculadora : usa
Cliente -.-> EmailService : envía notificaciones
Cliente -.-> LoggerUtil : registra eventos

note top of Cliente
  **Dependencia:**
  El Cliente DEPENDE de otros
  servicios pero no los "posee"
  
  Si cambia la interfaz de
  Calculadora, Cliente debe
  ser modificado también
end note

note bottom of Calculadora
  **Características:**
  • Relación temporal
  • Acoplamiento débil
  • No hay navegabilidad
  • "Usa" o "requiere"
end note
@enduml
                        </div>
                        <div id="relation-dependency-diagram">Cargando ejemplo...</div>
                    </div>

                    <div class="uml-element">
                        <h5>🔗 Asociación</h5>
                        <p><strong>Descripción:</strong> Relación estructural que describe vínculos entre objetos</p>
                        <p><strong>Representación visual:</strong> Línea sólida (--) con multiplicidades</p>
                        <p><strong>Ejemplo código:</strong> <code>Persona -- Empresa : trabaja en</code></p>
                        
                        <button class="toggle-btn" onclick="toggleCode('relation-association-example')">Ver Ejemplo PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('relation-association-example')">📋 Copiar</button>
                        
                        <div id="relation-association-example" class="code-container" style="display: none;">
@startuml Relaciones_Asociacion
!theme cerulean-outline

class Persona {
  - nombre: String
  - edad: int
  + trabajar(): void
}

class Empresa {
  - nombre: String
  - direccion: String
  + contratarEmpleado(): void
}

class Proyecto {
  - nombre: String
  - fechaInicio: Date
  + asignarPersona(): void
}

class Universidad {
  - nombre: String
  - ciudad: String
}

class Estudiante {
  - matricula: String
  - carrera: String
}

' Asociaciones con multiplicidades y roles
Persona "empleado 1..*" -- "empleador 1..*" Empresa : trabaja en >
Persona "participante 2..5" -- "proyecto 1..*" Proyecto : participa en
Universidad "1" -- "estudiantes 100..*" Estudiante : educa

note top of Persona
  **Asociación Bidireccional:**
  Una persona puede trabajar
  en varias empresas, y una
  empresa tiene varios empleados
  
  Multiplicidades:
  • 1..* = uno o más
  • 2..5 = entre 2 y 5
  • 100..* = mínimo 100
end note

note right of Universidad
  **Navegabilidad:**
  La flecha indica dirección
  de navegación
  
  **Roles:**
  Se pueden especificar
  nombres de roles en
  cada extremo
end note
@enduml
                        </div>
                        <div id="relation-association-diagram">Cargando ejemplo...</div>
                    </div>

                    <div class="uml-element">
                        <h5>🔺 Generalización (Herencia)</h5>
                        <p><strong>Descripción:</strong> Relación donde un elemento especializado es sustituible por uno general</p>
                        <p><strong>Representación visual:</strong> Línea sólida con triángulo vacío (&lt;|--)</p>
                        <p><strong>Ejemplo código:</strong> <code>Vehiculo &lt;|-- Automovil</code></p>
                        
                        <button class="toggle-btn" onclick="toggleCode('relation-generalization-example')">Ver Ejemplo PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('relation-generalization-example')">📋 Copiar</button>
                        
                        <div id="relation-generalization-example" class="code-container" style="display: none;">
@startuml Relaciones_Generalizacion
!theme cerulean-outline

abstract class Vehiculo {
  # marca: String
  # modelo: String
  # anio: int
  + {abstract} acelerar(): void
  + {abstract} frenar(): void
  + obtenerInfo(): String
}

class Automovil {
  - numeroPuertas: int
  - tipoTransmision: String
  + acelerar(): void
  + frenar(): void
  + abrirPuerta(): void
}

class Motocicleta {
  - cilindrada: int
  - tipoManillar: String
  + acelerar(): void
  + frenar(): void
  + hacerCaballito(): void
}

class Bicicleta {
  - numVelocidades: int
  - tipoPedal: String
  + acelerar(): void
  + frenar(): void
  + pedalear(): void
}

abstract class VehiculoElectrico {
  # capacidadBateria: double
  # autonomia: int
  + cargarBateria(): void
  + obtenerNivelBateria(): double
}

class AutoElectrico {
  - sistemaRecuperacion: boolean
  + acelerar(): void
  + frenar(): void
  + activarRecuperacion(): void
}

' Relaciones de herencia
Vehiculo <|-- Automovil
Vehiculo <|-- Motocicleta
Vehiculo <|-- Bicicleta
Vehiculo <|-- VehiculoElectrico
VehiculoElectrico <|-- AutoElectrico

note top of Vehiculo
  **Clase Abstracta:**
  Define comportamiento común
  pero no puede ser instanciada
  
  **Herencia múltiple de interfaces
  está permitida, de clases NO**
end note

note right of AutoElectrico
  **Herencia Múltiple:**
  AutoElectrico hereda de
  VehiculoElectrico que a su
  vez hereda de Vehiculo
  
  **Principio de Sustitución:**
  Un AutoElectrico PUEDE ser
  usado donde se espere un Vehiculo
end note
@enduml
                        </div>
                        <div id="relation-generalization-diagram">Cargando ejemplo...</div>
                    </div>

                    <div class="uml-element">
                        <h5>🔌 Realización (Implementación)</h5>
                        <p><strong>Descripción:</strong> Relación donde un elemento implementa otro (interface)</p>
                        <p><strong>Representación visual:</strong> Línea punteada con triángulo vacío (&lt;|..)</p>
                        <p><strong>Ejemplo código:</strong> <code>Volador &lt;|.. Avion</code></p>
                        
                        <button class="toggle-btn" onclick="toggleCode('relation-realization-example')">Ver Ejemplo PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('relation-realization-example')">📋 Copiar</button>
                        
                        <div id="relation-realization-example" class="code-container" style="display: none;">
@startuml Relaciones_Realizacion
!theme cerulean-outline

interface Volador {
  + despegar(): void
  + volar(): void
  + aterrizar(): void
  + obtenerAltitudMaxima(): int
}

interface Nadador {
  + nadar(): void
  + bucear(): void
  + salirDelAgua(): void
  + obtenerProfundidadMaxima(): int
}

interface Reproducible {
  + play(): void
  + pause(): void
  + stop(): void
  + setVolume(nivel: int): void
}

class Avion {
  - altitudActual: int
  - velocidad: double
  + despegar(): void
  + volar(): void
  + aterrizar(): void
  + obtenerAltitudMaxima(): int
}

class Pato {
  - especie: String
  - habitat: String
  + despegar(): void
  + volar(): void
  + aterrizar(): void
  + obtenerAltitudMaxima(): int
  + nadar(): void
  + bucear(): void
  + salirDelAgua(): void
  + obtenerProfundidadMaxima(): int
}

class ReproductorMP3 {
  - cancionActual: String
  - volumenActual: int
  + play(): void
  + pause(): void
  + stop(): void
  + setVolume(nivel: int): void
}

class SmartPhone {
  - sistemaOperativo: String
  - almacenamiento: int
  + play(): void
  + pause(): void
  + stop(): void
  + setVolume(nivel: int): void
  + realizarLlamada(): void
}

' Relaciones de realización/implementación
Volador <|.. Avion
Volador <|.. Pato
Nadador <|.. Pato
Reproducible <|.. ReproductorMP3
Reproducible <|.. SmartPhone

note top of Volador
  **Interface:**
  Define un contrato que deben
  cumplir las clases que la
  implementan
  
  **Sin implementación:**
  Solo define qué métodos
  deben existir, no cómo
end note

note right of Pato
  **Múltiples Interfaces:**
  Una clase puede implementar
  varias interfaces
  
  **Polimorfismo:**
  Un Pato puede ser tratado
  como Volador O como Nadador
  según el contexto
end note

note bottom of SmartPhone
  **Flexibilidad:**
  Múltiples clases pueden
  implementar la misma
  interface de formas diferentes
end note
@enduml
                        </div>
                        <div id="relation-realization-diagram">Cargando ejemplo...</div>
                    </div>

                    
                </div>

                <div id="structure-diagrams" class="phase-header">🏗️ Diagramas de Estructura</div>
                <div class="phase-content">
                    <h3>1. Diagrama de Clases</h3>
                    <div class="description">
                        <strong>Propósito:</strong> Mostrar la estructura estática del sistema mediante clases, interfaces y sus relaciones.
                        <br><strong>Elementos principales:</strong>
                        <ul>
                            <li>Clases con atributos y métodos</li>
                            <li>Interfaces</li>
                            <li>Relaciones (asociación, herencia, composición, agregación)</li>
                        </ul>
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('uml-class-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('uml-class-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('uml-class-diagram', 'png', 'diagrama-clases-uml'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('uml-class-diagram', 'svg', 'diagrama-clases-uml'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('uml-class-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>
                    <div id="uml-class-example" class="code-container" style="display: none;">
@startuml DiagramaClases
!theme cerulean-outline
skinparam backgroundColor #F8F9FA

class Persona {
    -nombre: String
    -edad: int
    -email: String
    +getNombre(): String
    +setNombre(nombre: String): void
    +calcularEdad(): int
}

class Empleado {
    -numeroEmpleado: String
    -salario: double
    -fechaContratacion: Date
    +calcularSalarioAnual(): double
    +obtenerAntiguedad(): int
}

class Departamento {
    -nombre: String
    -codigo: String
    -presupuesto: double
    +agregarEmpleado(emp: Empleado): void
    +calcularNomina(): double
}

interface Trabajo {
    +realizarTrabajo(): void
    +reportarProgreso(): String
}

Persona <|-- Empleado
Empleado ..|> Trabajo
Departamento "1" -- "many" Empleado : contiene
@enduml
                    </div>
                    <div id="uml-class-diagram">Cargando diagrama...</div>

                    

                    <div class="uml-element">
                        <h5>📊 Resumen de Multiplicidades</h5>
                        <div class="description">
                            <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                                <tr style="background-color: #f0f0f0;">
                                    <th style="border: 1px solid #ddd; padding: 8px;">Multiplicidad</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">Significado</th>
                                    <th style="border: 1px solid #ddd; padding: 8px;">Ejemplo</th>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;"><code>1</code></td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Exactamente uno</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Una persona tiene exactamente una cédula</td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;"><code>0..1</code></td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Cero o uno</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Una persona puede tener una licencia de conducir o no</td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;"><code>*</code> o <code>0..*</code></td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Cero o muchos</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Una persona puede tener ningún o varios teléfonos</td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;"><code>1..*</code></td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Uno o muchos</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Una empresa debe tener al menos un empleado</td>
                                </tr>
                                <tr>
                                    <td style="border: 1px solid #ddd; padding: 8px;"><code>n..m</code></td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Entre n y m</td>
                                    <td style="border: 1px solid #ddd; padding: 8px;">Un equipo tiene entre 5 y 11 jugadores</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                </div>

                <div class="uml-section">
                    <h3>📦 2. Diagrama de Objetos</h3>
                    <div class="description">
                        <strong>Propósito:</strong> Mostrar instancias específicas de clases en un momento determinado del sistema.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('uml-object-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('uml-object-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('uml-object-diagram', 'png', 'diagrama-objetos'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('uml-object-diagram', 'svg', 'diagrama-objetos'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('uml-object-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="uml-object-example" style="display:none;" class="plant-code">
@startuml DiagramaObjetos
!theme cerulean-outline
object "juan: Persona" as juan {
    nombre = "Juan Pérez"
    edad = 35
    email = "juan@empresa.com"
}

object "maria: Persona" as maria {
    nombre = "María García"
    edad = 28
    email = "maria@empresa.com"
}

object "ventas: Departamento" as ventas {
    nombre = "Ventas"
    codigo = "VTA001"
    presupuesto = 500000
}

juan -- ventas
maria -- ventas
@enduml
                    </div>
                    <div id="uml-object-diagram">Cargando diagrama...</div>
                </div>

                <div class="uml-section">
                    <h3>🔄 3. Diagrama de Componentes</h3>
                    <div class="description">
                        <strong>Propósito:</strong> Mostrar la estructura y dependencias entre componentes de software.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('uml-component-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('uml-component-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('uml-component-diagram', 'png', 'diagrama-componentes-uml'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('uml-component-diagram', 'svg', 'diagrama-componentes-uml'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('uml-component-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>
                    <div id="uml-component-example" class="code-container" style="display: none;">
@startuml DiagramaComponentes
!theme cerulean-outline
skinparam backgroundColor #F8F9FA

package "Capa de Presentación" {
    component [Interfaz Web] as web
    component [API REST] as api
}

package "Capa de Negocio" {
    component [Servicio Usuario] as userService
    component [Servicio Producto] as productService
    component [Validador] as validator
}

package "Capa de Datos" {
    component [DAO Usuario] as userDAO
    component [DAO Producto] as productDAO
    database "Base de Datos" as db
}

web --> api
api --> userService
api --> productService
userService --> validator
userService --> userDAO
productService --> productDAO
userDAO --> db
productDAO --> db
@enduml
                    </div>
                    <div id="uml-component-diagram">Cargando diagrama...</div>
                </div>

                <div class="uml-section">
                    <h3>🌐 4. Diagrama de Despliegue</h3>
                    <div class="description">
                        <strong>Propósito:</strong> Mostrar la arquitectura física del sistema y la distribución de componentes.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('uml-deployment-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('uml-deployment-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('uml-deployment-diagram', 'png', 'diagrama-despliegue'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('uml-deployment-diagram', 'svg', 'diagrama-despliegue'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('uml-deployment-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="uml-deployment-example" class="code-container" style="display: none;">
@startuml DiagramaDespliegue
!theme cerulean-outline
node "Servidor Web" as webServer {
    component [Aplicación Web] as webapp
    component [Servidor HTTP] as httpServer
}

node "Servidor de Aplicaciones" as appServer {
    component [API REST] as restApi
    component [Servicios de Negocio] as businessServices
}

node "Servidor de Base de Datos" as dbServer {
    database [Base de Datos] as database
}

node "Cliente" as client {
    component [Navegador Web] as browser
}

browser --> httpServer : HTTPS
httpServer --> webapp
webapp --> restApi : HTTP/REST
restApi --> businessServices
businessServices --> database : SQL

webServer <==> appServer : LAN
appServer <==> dbServer : LAN
@enduml
                    </div>
                    <div id="uml-deployment-diagram">Cargando diagrama...</div>
                </div>

                <div class="uml-section">
                    <h3>📦 5. Diagrama de Paquetes</h3>
                    <div class="description">
                        <strong>Propósito:</strong> Organizar elementos del modelo en grupos relacionados.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('uml-package-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('uml-package-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('uml-package-diagram', 'png', 'diagrama-paquetes'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('uml-package-diagram', 'svg', 'diagrama-paquetes'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('uml-package-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="uml-package-example" class="code-container" style="display: none;">
@startuml DiagramaPaquetes
!theme cerulean-outline
package "Sistema de Ventas" {
    package "Modulo Cliente" as cliente {
        class Cliente
        class Direccion
    }
    
    package "Modulo Producto" as producto {
        class Producto
        class Categoria
        class Inventario
    }
    
    package "Modulo Pedido" as pedido {
        class Pedido
        class DetallePedido
        class Factura
    }
}

package "Sistema de Pagos" as pagos {
    class ProcesadorPago
    class TarjetaCredito
}

cliente --> pedido : usa
producto --> pedido : usa
pedido --> pagos : usa
@enduml
                    </div>
                    <div id="uml-package-diagram">Cargando diagrama...</div>
                </div>

                <div id="behavior-diagrams" class="phase-header">🎭 Diagramas de Comportamiento</div>
                <div class="phase-content">
                    <h3>1. Diagrama de Casos de Uso</h3>
                    <div class="description">
                        <strong>Propósito:</strong> Describir la funcionalidad del sistema desde la perspectiva del usuario.
                        <br><strong>Elementos principales:</strong>
                        <ul>
                            <li><strong>Actores:</strong> Usuarios externos del sistema</li>
                            <li><strong>Casos de Uso:</strong> Funcionalidades específicas</li>
                            <li><strong>Relaciones:</strong> Include, extend, generalización</li>
                        </ul>
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('uml-usecase-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('uml-usecase-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('uml-usecase-diagram', 'png', 'diagrama-casos-uso-uml'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('uml-usecase-diagram', 'svg', 'diagrama-casos-uso-uml'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('uml-usecase-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>
                    <div id="uml-usecase-example" class="code-container" style="display: none;">
@startuml CasosDeUso
!theme cerulean-outline
left to right direction

actor "Sistema de Pago" as sistemaPago
actor "Cliente" as cliente
actor "Sistema" as sistema
actor "Administrador" as admin

package "Sistema de E-commerce" {
    usecase "Iniciar Sesión" as login
    usecase "Validar Usuario" as validarUsuario
    usecase "Registrar Usuario" as registrar
    usecase "Registrar con Google" as googleReg
    usecase "Registrar con Facebook" as facebookReg
    usecase "Realizar Pedido" as pedido
    usecase "Aplicar Descuento" as descuento
    usecase "Procesar Pago" as pago
    usecase "Validar Pago" as validar
    usecase "Buscar Producto" as buscar
    usecase "Agregar al Carrito" as agregar
    usecase "Gestionar Inventario" as inventario
    usecase "Ver Reportes" as reportes
    usecase "Reporte de Ventas" as reporteVentas
    usecase "Reporte de Usuarios" as reporteUsuarios
}

admin --> inventario
admin --> reportes
reportes <|-- reporteVentas
reportes <|-- reporteUsuarios

sistema --> validarUsuario
validarUsuario <. login : &lt;&lt;include&gt;&gt;
cliente --> login

sistemaPago --> pago
pago <. pedido : &lt;&lt;include&gt;&gt;
pago .> validar : &lt;&lt;include&gt;&gt;
cliente --> pedido
descuento .> pedido : &lt;&lt;extend&gt;&gt;

cliente --> buscar
cliente --> agregar

cliente --> registrar
registrar <|-- googleReg
registrar <|-- facebookReg

@enduml
                    </div>

                    <div id="uml-usecase-diagram">Cargando diagrama...</div>

                    <h4>Relaciones en Casos de Uso</h4>
                    <ul>
                        <li><strong>Include:</strong> <code>&lt;&lt;include&gt;&gt;</code> - Funcionalidad que siempre se ejecuta</li>
                        <li><strong>Extend:</strong> <code>&lt;&lt;extend&gt;&gt;</code> - Funcionalidad opcional</li>
                        <li><strong>Generalización:</strong> Especialización de casos de uso</li>
                    </ul>

                    <h3>2. Diagrama de Actividades</h3>
                    <div class="description">
                        <strong>Propósito:</strong> Modelar el flujo de trabajo y procesos de negocio.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('uml-activity-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('uml-activity-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('uml-activity-diagram', 'png', 'diagrama-actividad-uml'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('uml-activity-diagram', 'svg', 'diagrama-actividad-uml'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('uml-activity-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>
                    <div id="uml-activity-example" class="code-container" style="display: none;">
@startuml DiagramaActividades
!theme cerulean-outline
start
:Usuario solicita login;
:Validar credenciales;

if (¿Credenciales válidas?) then (sí)
    :Crear sesión;
    :Mostrar página principal;
    
    fork
        :Actualizar log de acceso;
    fork again
        :Verificar notificaciones;
    end fork
    
else (no)
    :Mostrar error;
    :Incrementar contador fallos;
    
    if (¿Excede límite intentos?) then (sí)
        :Bloquear cuenta;
        :Enviar notificación seguridad;
    else (no)
        :Permitir nuevo intento;
    endif
endif

stop
@enduml
                    </div>
                    <div id="uml-activity-diagram">Cargando diagrama...</div>

                    <h4>Elementos del Diagrama de Actividades</h4>
                    <ul>
                        <li><strong>Nodo inicial:</strong> Inicio del flujo</li>
                        <li><strong>Nodo final:</strong> Fin del flujo</li>
                        <li><strong>Actividad:</strong> Paso del proceso</li>
                        <li><strong>Decisión:</strong> Punto de bifurcación</li>
                        <li><strong>Merge:</strong> Punto de unión</li>
                        <li><strong>Fork:</strong> División paralela</li>
                        <li><strong>Join:</strong> Unión de flujos paralelos</li>
                    </ul>
                </div>

                <div class="uml-section">
                    <h3>🔄 3. Diagrama de Estados</h3>
                    <div class="description">
                        <strong>Propósito:</strong> Mostrar los estados de un objeto y las transiciones entre ellos.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('uml-state-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('uml-state-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('uml-state-diagram', 'png', 'diagrama-estados'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('uml-state-diagram', 'svg', 'diagrama-estados'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('uml-state-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="uml-state-example" class="code-container" style="display: none;">
@startuml DiagramaEstados
!theme cerulean-outline
[*] --> Creado : nuevo pedido

Creado --> Confirmado : confirmar()
Creado --> Cancelado : cancelar()

Confirmado --> EnProceso : procesar()
Confirmado --> Cancelado : cancelar()

EnProceso --> Enviado : enviar()
EnProceso --> Cancelado : cancelar()

Enviado --> Entregado : entregar()
Enviado --> Devuelto : devolver()

Entregado --> [*]
Cancelado --> [*]
Devuelto --> [*]

state Confirmado {
    [*] --> PendientePago
    PendientePago --> PagoConfirmado : pago recibido
    PagoConfirmado --> [*]
}
@enduml
                    </div>
                    <div id="uml-state-diagram">Cargando diagrama...</div>
                </div>

                <div id="interaction-diagrams" class="phase-header">💬 Diagramas de Interacción</div>
                <div class="phase-content">
                    <h3>1. Diagrama de Secuencia</h3>
                    <div class="description">
                        <strong>Propósito:</strong> Mostrar la interacción entre objetos a lo largo del tiempo.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('uml-sequence-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('uml-sequence-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('uml-sequence-diagram', 'png', 'diagrama-secuencia-uml'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('uml-sequence-diagram', 'svg', 'diagrama-secuencia-uml'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('uml-sequence-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>
                    <div id="uml-sequence-example" class="code-container" style="display: none;">
@startuml DiagramaSecuencia
!theme cerulean-outline
actor Usuario as user
participant "Interface Web" as web
participant "Controlador" as controller
participant "Servicio Usuario" as service
participant "DAO Usuario" as dao
database "Base Datos" as db

user -> web: login(usuario, password)
activate web

web -> controller: autenticar(usuario, password)
activate controller

controller -> service: validarUsuario(usuario, password)
activate service

service -> dao: buscarPorCredenciales(usuario, password)
activate dao

dao -> db: SELECT * FROM usuarios WHERE...
activate db
db --> dao: resultado
deactivate db

dao --> service: Usuario encontrado
deactivate dao

service -> service: validarPassword()

alt credenciales válidas
    service --> controller: Usuario autenticado
    controller --> web: token de sesión
    web --> user: acceso concedido
else credenciales inválidas
    service --> controller: error autenticación
    controller --> web: mensaje error
    web --> user: acceso denegado
end

deactivate service
deactivate controller
deactivate web
@enduml
                    </div>
                    <div id="uml-sequence-diagram">Cargando diagrama...</div>

                    <h4>Elementos del Diagrama de Secuencia</h4>
                    <ul>
                        <li><strong>Participantes:</strong> Objetos o actores</li>
                        <li><strong>Línea de vida:</strong> Línea vertical que representa la existencia</li>
                        <li><strong>Mensajes:</strong> Flechas que representan comunicación</li>
                        <li><strong>Activación:</strong> Rectángulo que muestra cuando un objeto está activo</li>
                        <li><strong>Fragmentos combinados:</strong> alt, opt, loop, par, etc.</li>
                    </ul>
                </div>

                <div class="uml-section">
                    <h3>📞 2. Diagrama de Comunicación</h3>
                    <div class="description">
                        <strong>Propósito:</strong> Mostrar interacciones entre objetos enfocándose en la estructura.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('uml-communication-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('uml-communication-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('uml-communication-diagram', 'png', 'diagrama-comunicacion'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('uml-communication-diagram', 'svg', 'diagrama-comunicacion'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('uml-communication-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="uml-communication-example" class="code-container" style="display: none;">
@startuml DiagramaComunicacion
!theme cerulean-outline

'left to right direction

' Objetos principales

object "pedido: Pedido" as pedido
object "cliente: Cliente" as cliente
object "producto: Producto" as producto
object "inventario: Inventario" as inventario

' Mensajes principales
cliente -> pedido : 1: crearPedido()
pedido -> producto : 2: obtenerPrecio()
pedido --> inventario : 4: verificarStock()

' Respuestas
producto -> pedido : 3: precio
inventario --> pedido : 5: stockDisponible
pedido -> cliente : 6: pedidoCreado

@enduml
                    </div>
                    <div id="uml-communication-diagram">Cargando diagrama...</div>
                </div>

                <div class="uml-section">
                    <h3>⏰ 3. Diagrama de Tiempo</h3>
                    <div class="description">
                        <strong>Propósito:</strong> Mostrar cambios de estado a lo largo del tiempo.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('uml-timing-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('uml-timing-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('uml-timing-diagram', 'png', 'diagrama-tiempo'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('uml-timing-diagram', 'svg', 'diagrama-tiempo'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('uml-timing-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="uml-timing-example" class="code-container" style="display: none;">
@startuml DiagramaTiempo
!theme cerulean-outline
robust "Estado Pedido" as pedido
robust "Estado Pago" as pago
robust "Estado Inventario" as inventario

@pedido
0 is Nuevo
+5 is Confirmado  
+10 is Procesando
+15 is Enviado
+20 is Entregado

@pago
0 is Pendiente
+3 is Procesando
+7 is Aprobado
+25 is Completado

@inventario
0 is Disponible
+12 is Reservado
+18 is Comprometido
+22 is Actualizado

@5
pedido -> pago : solicitar pago

@12
pedido -> inventario : reservar items

@20
pedido -> inventario : confirmar entrega
@enduml
                    </div>
                    <div id="uml-timing-diagram">Cargando diagrama...</div>
                </div>

                <div id="plantuml-tool" class="phase-header">🛠️ PlantUML: Herramienta Práctica</div>
                <div class="phase-content">
                    <h3>Instalación y Configuración</h3>
                    
                    <h4>Prerequisitos</h4>
                    <div class="description">
                        <code>
                        # Java Runtime Environment<br>
                        java -version<br><br>
                        # Graphviz (para algunos diagramas)<br>
                        sudo apt-get install graphviz  # Linux<br>
                        brew install graphviz          # macOS
                        </code>
                    </div>

                    <h4>Instalación de PlantUML</h4>
                    <div class="description">
                        <code>
                        # Descargar plantuml.jar<br>
                        wget http://sourceforge.net/projects/plantuml/files/plantuml.jar/download<br><br>
                        # Crear alias (opcional)<br>
                        alias plantuml='java -jar ~/plantuml.jar'
                        </code>
                    </div>

                    <h4>Uso Básico</h4>
                    <div class="description">
                        <code>
                        # Generar diagrama<br>
                        java -jar plantuml.jar diagrama.puml<br><br>
                        # Generar en formato específico<br>
                        java -jar plantuml.jar -tpng diagrama.puml<br>
                        java -jar plantuml.jar -tsvg diagrama.puml
                        </code>
                    </div>

                    <h3>Sintaxis Fundamental</h3>

                    <h4>Estructura Básica</h4>
                    <div class="description">
                        <code>
                        @startuml NombreDiagrama<br>
                        ' Contenido del diagrama<br>
                        @enduml
                        </code>
                    </div>

                    <h4>Directivas Comunes</h4>
                    <div class="description">
                        <code>
                        @startuml<br>
                        !theme amiga<br>
                        scale 1.5<br>
                        left to right direction<br>
                        skinparam backgroundColor #EEEEEE<br>
                        @enduml
                        </code>
                    </div>
                </div>

                <div id="best-practices" class="phase-header">✨ Buenas Prácticas</div>
                <div class="phase-content">
                    <h3>Modelado Efectivo</h3>

                    <h4>1. Principios Generales</h4>
                    <ul>
                        <li><strong>Simplicidad:</strong> Mantener diagramas comprensibles</li>
                        <li><strong>Consistencia:</strong> Usar convenciones uniformes</li>
                        <li><strong>Precisión:</strong> Ser exacto en las relaciones</li>
                        <li><strong>Completitud:</strong> Incluir elementos relevantes</li>
                    </ul>

                    <h4>2. Nomenclatura</h4>
                    <div class="description">
                        <strong>✅ BIEN:</strong><br>
                        <code>
                        class UsuarioRegistrado {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;-numeroIdentificacion: String<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;+obtenerDatosPersonales(): DatosPersonales<br>
                        }
                        </code>
                        <br><br>
                        <strong>❌ MAL:</strong><br>
                        <code>
                        class usr {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;-id: String<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;+getData(): Object<br>
                        }
                        </code>
                    </div>

                    <h4>3. Organización Visual</h4>
                    <ul>
                        <li>Agrupar elementos relacionados</li>
                        <li>Usar colores consistentemente</li>
                        <li>Mantener layout ordenado</li>
                        <li>Evitar cruces de líneas innecesarios</li>
                    </ul>

                    <h3>Errores Comunes a Evitar</h3>

                    <h4>1. Sobremodeling</h4>
                    <div class="description">
                        Evitar agregar demasiado detalle en las fases iniciales del análisis. Comenzar con modelos simples y agregar complejidad gradualmente.
                    </div>

                    <h4>2. Relaciones Ambiguas</h4>
                    <div class="description">
                        <strong>❌ MAL:</strong> <code>Persona -- Empresa</code><br>
                        <strong>✅ BIEN:</strong> <code>Persona "empleado" --> "empleador" Empresa : trabaja en</code>
                    </div>

                    <h4>3. Diagramas Sobrecargados</h4>
                    <ul>
                        <li>Máximo 7-12 clases por diagrama</li>
                        <li>Dividir en múltiples vistas si es necesario</li>
                        <li>Usar diagramas de paquetes para organizar</li>
                    </ul>
                </div>

                <div id="case-studies" class="phase-header">📚 Casos de Estudio</div>
                <div class="phase-content">
                    <h3>📖 Caso 1: Sistema de Biblioteca</h3>
                    
                    <h4>Análisis de Requisitos</h4>
                    <div class="description">
                        <strong>Actores identificados:</strong>
                        <ul>
                            <li>Bibliotecario</li>
                            <li>Usuario/Lector</li>
                            <li>Sistema externo de multas</li>
                        </ul>
                        <strong>Casos de uso principales:</strong>
                        <ul>
                            <li>Registrar libro</li>
                            <li>Prestar libro</li>
                            <li>Devolver libro</li>
                            <li>Buscar libro</li>
                            <li>Gestionar usuarios</li>
                        </ul>
                    </div>

                    <h4>Diagrama de Casos de Uso - Biblioteca</h4>
                    <button class="toggle-btn" onclick="toggleCode('library-usecase-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('library-usecase-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('library-usecase-diagram', 'png', 'biblioteca-casos-uso'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('library-usecase-diagram', 'svg', 'biblioteca-casos-uso'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('library-usecase-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="library-usecase-example" class="code-container" style="display: none;">
@startuml CasoBiblioteca
actor Bibliotecario as bib
actor Usuario as user
actor "Sistema Multas" as multas

package "Sistema Biblioteca" {
    usecase "Registrar Libro" as registrar
    usecase "Buscar Libro" as buscar
    usecase "Prestar Libro" as prestar
    usecase "Devolver Libro" as devolver
    usecase "Verificar Disponibilidad" as verificar
    usecase "Calcular Multa" as calcular
    usecase "Gestionar Usuarios" as gestionUser
}

bib --> registrar
bib --> prestar
bib --> devolver
bib --> gestionUser

user --> buscar

prestar .> verificar : include
devolver .> calcular : include

calcular --> multas

buscar <|-- "Búsqueda Avanzada"
@enduml
                    </div>
                    <div id="library-usecase-diagram">Cargando diagrama...</div>

                    <h4>Modelo de Dominio - Biblioteca</h4>
                    <button class="toggle-btn" onclick="toggleCode('library-domain-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('library-domain-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('library-domain-diagram', 'png', 'biblioteca-dominio'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('library-domain-diagram', 'svg', 'biblioteca-dominio'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('library-domain-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="library-domain-example" class="code-container" style="display: none;">
@startuml ModeloBiblioteca
class Usuario {
    -codigo: String
    -nombre: String
    -telefono: String
    -email: String
    -fechaRegistro: Date
    -estado: EstadoUsuario
}

class Libro {
    -isbn: String
    -titulo: String
    -autor: String
    -editorial: String
    -anioPublicacion: int
    -categoria: Categoria
}

class EjemplarLibro {
    -numeroEjemplar: String
    -estado: EstadoEjemplar
    -ubicacion: String
    -fechaAdquisicion: Date
}

class Prestamo {
    -numeroPrestamo: String
    -fechaPrestamo: Date
    -fechaVencimiento: Date
    -fechaDevolucion: Date
    -estado: EstadoPrestamo
}

class Multa {
    -numeroMulta: String
    -monto: double
    -fechaGeneracion: Date
    -fechaPago: Date
    -motivo: String
}

enum EstadoUsuario {
    ACTIVO
    SUSPENDIDO
    INACTIVO
}

enum EstadoEjemplar {
    DISPONIBLE
    PRESTADO
    MANTENIMIENTO
    PERDIDO
}

enum EstadoPrestamo {
    ACTIVO
    DEVUELTO
    VENCIDO
}

Usuario "1" -- "0..*" Prestamo
Prestamo "1" -- "1" EjemplarLibro
Libro "1" -- "1..*" EjemplarLibro
Prestamo "1" -- "0..1" Multa
@enduml
                    </div>
                    <div id="library-domain-diagram">Cargando diagrama...</div>

                    <h4>Diagrama de Secuencia - Prestar Libro</h4>
                    <button class="toggle-btn" onclick="toggleCode('library-sequence-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('library-sequence-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('library-sequence-diagram', 'png', 'biblioteca-secuencia-prestar'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('library-sequence-diagram', 'svg', 'biblioteca-secuencia-prestar'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('library-sequence-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="library-sequence-example" class="code-container" style="display: none;">
@startuml SecuenciaPrestar
actor Bibliotecario as bib
participant "Sistema" as sys
participant "ControladorPrestamo" as ctrl
participant "ServicioPrestamo" as serv
participant "RepositorioUsuario" as repoUser
participant "RepositorioEjemplar" as repoEjem

bib -> sys: prestarLibro(codigoUsuario, numeroEjemplar)
sys -> ctrl: procesarPrestamo(codigoUsuario, numeroEjemplar)

ctrl -> repoUser: buscarUsuario(codigoUsuario)
repoUser --> ctrl: usuario

ctrl -> repoEjem: buscarEjemplar(numeroEjemplar)
repoEjem --> ctrl: ejemplar

ctrl -> serv: validarPrestamo(usuario, ejemplar)

alt usuario y ejemplar válidos
    serv -> serv: crearPrestamo()
    serv -> repoEjem: actualizarEstado(numeroEjemplar, PRESTADO)
    serv --> ctrl: prestamo creado
    ctrl --> sys: éxito
    sys --> bib: préstamo realizado
else validación falla
    serv --> ctrl: error validación
    ctrl --> sys: mensaje error
    sys --> bib: mostrar error
end
@enduml
                    </div>
                    <div id="library-sequence-diagram">Cargando diagrama...</div>

                    <h3>🛒 Caso 2: Sistema de E-commerce</h3>
                    
                    <h4>Diagrama de Componentes - E-commerce</h4>
                    <button class="toggle-btn" onclick="toggleCode('ecommerce-component-example')">Ver/Ocultar Ejemplo PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('ecommerce-component-example')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('ecommerce-component-diagram', 'png', 'ecommerce-componentes'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('ecommerce-component-diagram', 'svg', 'ecommerce-componentes'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('ecommerce-component-example'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="ecommerce-component-example" class="code-container" style="display: none;">
@startuml ComponentesEcommerce
package "Frontend" {
    component [Aplicación Web] as web
    component [Aplicación Móvil] as mobile
}

package "API Gateway" {
    component [Gateway] as gateway
    component [Autenticación] as auth
    component [Rate Limiting] as rate
}

package "Microservicios" {
    component [Servicio Usuario] as userSvc
    component [Servicio Producto] as prodSvc
    component [Servicio Pedido] as orderSvc
    component [Servicio Pago] as paySvc
    component [Servicio Inventario] as invSvc
}

package "Datos" {
    database [DB Usuarios] as userDb
    database [DB Productos] as prodDb
    database [DB Pedidos] as orderDb
    database [Cache Redis] as cache
}

package "Servicios Externos" {
    component [Pasarela Pago] as payGw
    component [Servicio Envío] as shipping
}

web --> gateway
mobile --> gateway

gateway --> auth
gateway --> rate
gateway --> userSvc
gateway --> prodSvc
gateway --> orderSvc

userSvc --> userDb
prodSvc --> prodDb
prodSvc --> cache
orderSvc --> orderDb
orderSvc --> paySvc
orderSvc --> invSvc

paySvc --> payGw
orderSvc --> shipping

invSvc --> prodDb
@enduml
                    </div>
                    <div id="ecommerce-component-diagram">Cargando diagrama...</div>
                </div>

                <div id="design-patterns" class="phase-header">🎨 Patrones de Diseño en UML</div>
                <div class="phase-content">
                    <h3>Patrones Creacionales</h3>

                    <h4>Singleton</h4>
                    <div class="description">
                        Garantiza que una clase tenga una única instancia y proporciona un punto de acceso global a ella.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('singleton-pattern')">Ver/Ocultar Ejemplo Singleton</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('singleton-pattern')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('singleton-diagram', 'png', 'patron-singleton'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('singleton-diagram', 'svg', 'patron-singleton'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('singleton-pattern'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>
                    <div id="singleton-pattern" class="code-container" style="display: none;">
@startuml Singleton
!theme cerulean-outline
class DatabaseConnection {
    {static} -instance: DatabaseConnection
    -connection: Connection
    
    -DatabaseConnection()
    {static} +getInstance(): DatabaseConnection
    +getConnection(): Connection
    +closeConnection(): void
}

note right of DatabaseConnection::getInstance
    if (instance == null) {
        instance = new DatabaseConnection();
    }
    return instance;
end note
@enduml
                    </div>
                    <div id="singleton-diagram">Cargando diagrama...</div>

                    <h3>Patrones Estructurales</h3>

                    <h4>Adapter</h4>
                    <div class="description">
                        Permite que interfaces incompatibles trabajen juntas.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('adapter-pattern')">Ver/Ocultar Ejemplo Adapter</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('adapter-pattern')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('adapter-diagram', 'png', 'patron-adapter'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('adapter-diagram', 'svg', 'patron-adapter'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('adapter-pattern'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>
                    <div id="adapter-pattern" class="code-container" style="display: none;">
@startuml Adapter
!theme cerulean-outline
interface Target {
    +request(): void
}

class Client {
    +operation(): void
}

class Adapter {
    -adaptee: Adaptee
    +request(): void
}

class Adaptee {
    +specificRequest(): void
}

Client --> Target
Target <|.. Adapter
Adapter --> Adaptee

note right of Adapter::request
    adaptee.specificRequest();
end note
@enduml
                    </div>
                    <div id="adapter-diagram">Cargando diagrama...</div>

                    <h3>Patrones de Comportamiento</h3>

                    <h4>Observer</h4>
                    <div class="description">
                        Define una dependencia de uno a muchos entre objetos, de forma que cuando un objeto cambie de estado, todos sus dependientes sean notificados.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('observer-pattern')">Ver/Ocultar Ejemplo Observer</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('observer-pattern')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('observer-diagram', 'png', 'patron-observer'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('observer-diagram', 'svg', 'patron-observer'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('observer-pattern'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>
                    <div id="observer-pattern" class="code-container" style="display: none;">
@startuml Observer
!theme cerulean-outline
interface Subject {
    +attach(Observer): void
    +detach(Observer): void
    +notify(): void
}

interface Observer {
    +update(): void
}

class ConcreteSubject {
    -state: String
    -observers: List<Observer>
    
    +attach(Observer): void
    +detach(Observer): void
    +notify(): void
    +getState(): String
    +setState(String): void
}

class ConcreteObserver {
    -subject: ConcreteSubject
    -observerState: String
    
    +update(): void
}

Subject <|.. ConcreteSubject
Observer <|.. ConcreteObserver
ConcreteSubject "1" --> "0..*" Observer : observers
ConcreteObserver --> ConcreteSubject : subject
@enduml
                    </div>
                    <div id="observer-diagram">Cargando diagrama...</div>
                </div>

                <div class="pattern-section">
                    <h3>🏭 Factory Method</h3>
                    <div class="description">
                        Crea objetos sin especificar la clase exacta a crear. Define una interfaz para crear objetos, pero deja que las subclases decidan qué clase instanciar.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('factory-pattern')">Ver/Ocultar Código PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('factory-pattern')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('factory-diagram', 'png', 'patron-factory'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('factory-diagram', 'svg', 'patron-factory'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('factory-pattern'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="factory-pattern" class="code-container" style="display: none;">
@startuml FactoryMethod
abstract class DocumentFactory {
    +{abstract} createDocument(): Document
    +openDocument(): void
}

class PDFFactory {
    +createDocument(): Document
}

class WordFactory {
    +createDocument(): Document
}

abstract class Document {
    +{abstract} open(): void
    +{abstract} save(): void
}

class PDFDocument {
    +open(): void
    +save(): void
}

class WordDocument {
    +open(): void
    +save(): void
}

DocumentFactory <|-- PDFFactory
DocumentFactory <|-- WordFactory
Document <|-- PDFDocument
Document <|-- WordDocument

PDFFactory ..> PDFDocument : creates
WordFactory ..> WordDocument : creates
@enduml
                    </div>
                    <div id="factory-diagram">Cargando diagrama...</div>
                </div>

                <div class="pattern-section">
                    <h3>🌳 Composite</h3>
                    <div class="description">
                        Compone objetos en estructuras de árbol para representar jerarquías parte-todo. Permite a los clientes tratar objetos individuales y composiciones de manera uniforme.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('composite-pattern')">Ver/Ocultar Código PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('composite-pattern')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('composite-diagram', 'png', 'patron-composite'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('composite-diagram', 'svg', 'patron-composite'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('composite-pattern'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="composite-pattern" class="code-container" style="display: none;">
@startuml Composite
abstract class Component {
    #name: String
    +{abstract} operation(): void
    +add(Component): void
    +remove(Component): void
    +getChild(int): Component
}

class Leaf {
    +operation(): void
}

class Composite {
    -children: List<Component>
    +operation(): void
    +add(Component): void
    +remove(Component): void
    +getChild(int): Component
}

Component <|-- Leaf
Component <|-- Composite
Composite "1" *-- "0..*" Component : children
@enduml
                    </div>
                    <div id="composite-diagram">Cargando diagrama...</div>
                </div>

                <div class="pattern-section">
                    <h3>🎯 Strategy</h3>
                    <div class="description">
                        Define una familia de algoritmos, los encapsula y los hace intercambiables. Strategy permite que el algoritmo varíe independientemente de los clientes que lo usan.
                    </div>

                    <button class="toggle-btn" onclick="toggleCode('strategy-pattern')">Ver/Ocultar Código PlantUML</button>
                    <button class="toggle-btn copy-btn" onclick="copyCode('strategy-pattern')">📋 Copiar Código</button>
                    <div class="export-dropdown">
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('strategy-diagram', 'png', 'patron-strategy'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('strategy-diagram', 'svg', 'patron-strategy'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('strategy-pattern'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    </div>

                    <div id="strategy-pattern" class="code-container" style="display: none;">
@startuml Strategy
class Context {
    -strategy: Strategy
    +setStrategy(Strategy): void
    +executeStrategy(): void
}

interface Strategy {
    +execute(): void
}

class ConcreteStrategyA {
    +execute(): void
}

class ConcreteStrategyB {
    +execute(): void
}

class ConcreteStrategyC {
    +execute(): void
}

Context --> Strategy
Strategy <|.. ConcreteStrategyA
Strategy <|.. ConcreteStrategyB
Strategy <|.. ConcreteStrategyC
@enduml
                    </div>
                    <div id="strategy-diagram">Cargando diagrama...</div>
                </div>

                <div id="advanced-study" class="phase-header">🚀 Técnicas Avanzadas de Modelado</div>
                <div class="phase-content">
                    <h3>🎯 Estereotipos y Perfiles UML</h3>
                    
                    <h4>Definición de Estereotipos Personalizados</h4>
                    <div class="description">
                        Los estereotipos permiten extender UML para dominios específicos, creando elementos personalizados que se adapten mejor a las necesidades del proyecto.
                    </div>

                    <div class="example">
                        <h5>📋 Ejemplo: Estereotipos para Arquitectura Web</h5>
                        <button class="toggle-btn" onclick="toggleCode('stereotype-code')">Ver/Ocultar Código PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('stereotype-code')">📋 Copiar Código</button>
                        <div class="export-dropdown">
                            <button class="export-btn">📥 Exportar ▼</button>
                            <div class="dropdown-content">
                                <a href="#" onclick="exportDiagram('stereotype-diagram', 'png', 'estereotipos-web'); return false;">📥 Descargar PNG</a>
                                <a href="#" onclick="exportDiagram('stereotype-diagram', 'svg', 'estereotipos-web'); return false;">📄 Descargar SVG</a>
                                <a href="#" onclick="openInPlantText('stereotype-code'); return false;">🌐 Abrir en PlantText</a>
                            </div>
                        </div>

                        <div id="stereotype-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA

skinparam class {
    BackgroundColor<<Controller>> #FFE0B2
    BackgroundColor<<Service>> #E1F5FE 
    BackgroundColor<<Repository>> #E8F5E8
    BackgroundColor<<Entity>> #FFF3E0
    BackgroundColor<<DTO>> #F3E5F5
    BorderColor #424242
    FontSize 11
}

package "Arquitectura Web con Estereotipos" {
    
    class UserController <<Controller>> {
        +getUserById(id: Long): ResponseEntity<UserDTO>
        +createUser(userDTO: UserDTO): ResponseEntity<UserDTO>
        +updateUser(id: Long, userDTO: UserDTO): ResponseEntity<UserDTO>
        +deleteUser(id: Long): ResponseEntity<Void>
    }
    
    class UserService <<Service>> {
        +findById(id: Long): User
        +createUser(userData: UserDTO): User
        +updateUser(id: Long, userData: UserDTO): User
        +deleteUser(id: Long): void
        +validateUserData(userData: UserDTO): boolean
    }
    
    class UserRepository <<Repository>> {
        +findById(id: Long): Optional<User>
        +save(user: User): User
        +deleteById(id: Long): void
        +findByEmail(email: String): Optional<User>
        +findAllActiveUsers(): List<User>
    }
    
    class User <<Entity>> {
        -id: Long
        -name: String
        -email: String
        -createdAt: LocalDateTime
        -active: boolean
        +activate(): void
        +deactivate(): void
    }
    
    class UserDTO <<DTO>> {
        +id: Long
        +name: String
        +email: String
        +toEntity(): User
        +fromEntity(user: User): UserDTO
    }
}

UserController --> UserService : uses
UserService --> UserRepository : uses
UserRepository --> User : manages
UserController ..> UserDTO : <<uses>>
UserService ..> UserDTO : <<uses>>

note bottom of UserController
    <<Controller>>
    Maneja peticiones HTTP
    Validación de entrada
    Transformación de datos
end note

note bottom of UserService
    <<Service>>
    Lógica de negocio
    Validaciones complejas
    Orquestación de operaciones
end note

note bottom of UserRepository
    <<Repository>>
    Acceso a datos
    Abstracción de persistencia
    Consultas especializadas
end note

@enduml
                        </div>
                        <div id="stereotype-diagram">Cargando diagrama...</div>
                    </div>

                    <h3>🏗️ Patrones Arquitectónicos Modernos</h3>

                    <h4>1. Command Query Responsibility Segregation (CQRS)</h4>
                    <div class="description">
                        CQRS separa las operaciones de lectura (Query) de las de escritura (Command), permitiendo optimizar cada una independientemente.
                    </div>

                    <div class="example">
                        <h5>📊 Modelo CQRS con Event Sourcing</h5>
                        <button class="toggle-btn" onclick="toggleCode('cqrs-code')">Ver/Ocultar Código PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('cqrs-code')">📋 Copiar Código</button>
                        <div class="export-dropdown">
                            <button class="export-btn">📥 Exportar ▼</button>
                            <div class="dropdown-content">
                                <a href="#" onclick="exportDiagram('cqrs-diagram', 'png', 'patron-cqrs'); return false;">📥 Descargar PNG</a>
                                <a href="#" onclick="exportDiagram('cqrs-diagram', 'svg', 'patron-cqrs'); return false;">📄 Descargar SVG</a>
                                <a href="#" onclick="openInPlantText('cqrs-code'); return false;">🌐 Abrir en PlantText</a>
                            </div>
                        </div>

                        <div id="cqrs-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA

skinparam package {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
}

skinparam class {
    BackgroundColor #FFFFFF
    BorderColor #424242
    FontSize 10
}

skinparam interface {
    BackgroundColor #FFF3E0
    BorderColor #F57C00
}

package "Command Side" #LightBlue {
    
    interface CommandHandler {
        +handle(command: Command): void
    }
    
    class CreateUserCommand {
        +userId: UUID
        +name: String
        +email: String
        +timestamp: LocalDateTime
    }
    
    class UpdateUserCommand {
        +userId: UUID
        +name: String
        +email: String
        +version: Long
    }
    
    class UserCommandHandler {
        +handle(command: CreateUserCommand): void
        +handle(command: UpdateUserCommand): void
    }
    
    class UserAggregate {
        -id: UUID
        -version: Long
        -uncommittedEvents: List<Event>
        +createUser(command: CreateUserCommand): void
        +updateUser(command: UpdateUserCommand): void
        +getUncommittedEvents(): List<Event>
    }
    
    interface EventStore {
        +saveEvents(aggregateId: UUID, events: List<Event>): void
        +getEvents(aggregateId: UUID): List<Event>
    }
}

package "Query Side" #LightGreen {
    
    interface QueryHandler {
        +handle(query: Query): Object
    }
    
    class GetUserQuery {
        +userId: UUID
    }
    
    class GetUsersQuery {
        +pageSize: int
        +pageNumber: int
        +filter: UserFilter
    }
    
    class UserQueryHandler {
        +handle(query: GetUserQuery): UserReadModel
        +handle(query: GetUsersQuery): List<UserReadModel>
    }
    
    class UserReadModel {
        +id: UUID
        +name: String
        +email: String
        +createdAt: LocalDateTime
        +lastModified: LocalDateTime
    }
    
    interface ReadModelRepository {
        +findById(id: UUID): UserReadModel
        +findAll(filter: UserFilter): List<UserReadModel>
        +save(model: UserReadModel): void
    }
}

package "Event Processing" #LightYellow {
    
    class UserCreatedEvent {
        +userId: UUID
        +name: String
        +email: String
        +timestamp: LocalDateTime
    }
    
    class UserUpdatedEvent {
        +userId: UUID
        +name: String
        +email: String
        +version: Long
        +timestamp: LocalDateTime
    }
    
    class UserProjection {
        +on(event: UserCreatedEvent): void
        +on(event: UserUpdatedEvent): void
    }
}

' Relaciones Command Side
CommandHandler <|.. UserCommandHandler
UserCommandHandler --> UserAggregate : uses
UserAggregate --> EventStore : saves events

' Relaciones Query Side
QueryHandler <|.. UserQueryHandler
UserQueryHandler --> ReadModelRepository : uses
ReadModelRepository --> UserReadModel : manages

' Relaciones Event Processing
UserAggregate ..> UserCreatedEvent : publishes
UserAggregate ..> UserUpdatedEvent : publishes
UserProjection --> UserCreatedEvent : subscribes
UserProjection --> UserUpdatedEvent : subscribes
UserProjection --> ReadModelRepository : updates

note top of "Command Side"
    Maneja escrituras
    Validaciones de negocio
    Event Sourcing
end note

note top of "Query Side" 
    Optimizado para lecturas
    Modelos desnormalizados
    Alto rendimiento
end note

note top of "Event Processing"
    Proyecciones asíncronas
    Eventual consistency
    Event replay capability
end note

@enduml
                        </div>
                        <div id="cqrs-diagram">Cargando diagrama...</div>
                    </div>

                    <h4>2. Hexagonal Architecture (Ports & Adapters)</h4>
                    <div class="description">
                        La arquitectura hexagonal aísla la lógica de negocio de los detalles de implementación externos, facilitando las pruebas y el mantenimiento.
                    </div>

                    <div class="example">
                        <h5>🔧 Implementación de Arquitectura Hexagonal</h5>
                        <button class="toggle-btn" onclick="toggleCode('hexagonal-code')">Ver/Ocultar Código PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('hexagonal-code')">📋 Copiar Código</button>
                        <div class="export-dropdown">
                            <button class="export-btn">📥 Exportar ▼</button>
                            <div class="dropdown-content">
                                <a href="#" onclick="exportDiagram('hexagonal-diagram', 'png', 'arquitectura-hexagonal'); return false;">📥 Descargar PNG</a>
                                <a href="#" onclick="exportDiagram('hexagonal-diagram', 'svg', 'arquitectura-hexagonal'); return false;">📄 Descargar SVG</a>
                                <a href="#" onclick="openInPlantText('hexagonal-code'); return false;">🌐 Abrir en PlantText</a>
                            </div>
                        </div>

                        <div id="hexagonal-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA

skinparam package {
    BackgroundColor #E8F5E8
    BorderColor #4CAF50
}

skinparam class {
    BackgroundColor #FFFFFF
    BorderColor #424242
    FontSize 10
}

skinparam interface {
    BackgroundColor #FFF3E0
    BorderColor #F57C00
}

package "Infrastructure Layer" #LightGray {
    
    package "Driving Adapters" #LightBlue {
        class RestController {
            +createUser(request: CreateUserRequest): ResponseEntity
            +getUser(id: String): ResponseEntity
        }
        
        class GraphQLResolver {
            +user(id: String): User
            +createUser(input: CreateUserInput): User
        }
        
        class CLIController {
            +executeCommand(command: String[]): void
        }
    }
    
    package "Driven Adapters" #LightCoral {
        class JpaUserRepository {
            +save(user: User): User
            +findById(id: UserId): Optional<User>
        }
        
        class EmailService {
            +sendWelcomeEmail(user: User): void
            +sendPasswordReset(email: Email): void
        }
        
        class AuditLogger {
            +logUserCreation(user: User): void
            +logUserUpdate(user: User): void
        }
    }
}

package "Application Layer" #LightYellow {
    
    package "Ports" {
        interface UserRepository {
            +save(user: User): User
            +findById(id: UserId): Optional<User>
        }
        
        interface NotificationService {
            +sendWelcomeEmail(user: User): void
        }
        
        interface AuditService {
            +logUserAction(action: String, user: User): void
        }
        
        interface UserService {
            +createUser(command: CreateUserCommand): User
            +getUser(id: UserId): User
        }
    }
    
    class UserServiceImpl {
        +createUser(command: CreateUserCommand): User
        +getUser(id: UserId): User
        -validateUserData(userData: UserData): void
    }
}

package "Domain Layer" #LightGreen {
    
    class User {
        -id: UserId
        -name: UserName
        -email: Email
        -registrationDate: LocalDateTime
        +create(name: UserName, email: Email): User
        +updateEmail(newEmail: Email): void
        +isActive(): boolean
    }
    
    class UserId {
        -value: UUID
        +toString(): String
        +equals(other: UserId): boolean
    }
    
    class UserName {
        -value: String
        +validate(): boolean
        +toString(): String
    }
    
    class Email {
        -value: String
        +validate(): boolean
        +getDomain(): String
    }
    
    class UserCreatedEvent {
        +userId: UserId
        +name: UserName
        +email: Email
        +timestamp: LocalDateTime
    }
}

' Driving Adapters -> Application
RestController --> UserService : uses
GraphQLResolver --> UserService : uses
CLIController --> UserService : uses

' Application -> Domain
UserServiceImpl ..|> UserService
UserServiceImpl --> User : manages
UserServiceImpl --> UserRepository : uses
UserServiceImpl --> NotificationService : uses
UserServiceImpl --> AuditService : uses

' Driven Adapters -> Ports
JpaUserRepository ..|> UserRepository
EmailService ..|> NotificationService
AuditLogger ..|> AuditService

' Domain relationships
User --> UserId : has
User --> UserName : has
User --> Email : has
User ..> UserCreatedEvent : publishes

note top of "Domain Layer"
    Core Business Logic
    No external dependencies
    Pure domain objects
end note

note right of "Application Layer"
    Use cases
    Orchestration
    Port definitions
end note

note bottom of "Infrastructure Layer"
    External concerns
    Frameworks
    Databases, APIs
end note

@enduml
                        </div>
                        <div id="hexagonal-diagram">Cargando diagrama...</div>
                    </div>

                    <h3>🔬 Microservicios y Domain-Driven Design</h3>
                    
                    <h4>Bounded Contexts y Aggregate Design</h4>
                    <div class="description">
                        El diseño de agregados en DDD define límites transaccionales claros y mantiene la consistencia dentro de cada contexto delimitado.
                    </div>

                    <div class="example">
                        <h5>🏢 Sistema de E-commerce con Bounded Contexts</h5>
                        <button class="toggle-btn" onclick="toggleCode('ddd-code')">Ver/Ocultar Código PlantUML</button>
                        <button class="toggle-btn copy-btn" onclick="copyCode('ddd-code')">📋 Copiar Código</button>
                        <div class="export-dropdown">
                            <button class="export-btn">📥 Exportar ▼</button>
                            <div class="dropdown-content">
                                <a href="#" onclick="exportDiagram('ddd-diagram', 'png', 'ddd-bounded-contexts'); return false;">📥 Descargar PNG</a>
                                <a href="#" onclick="exportDiagram('ddd-diagram', 'svg', 'ddd-bounded-contexts'); return false;">📄 Descargar SVG</a>
                                <a href="#" onclick="openInPlantText('ddd-code'); return false;">🌐 Abrir en PlantText</a>
                            </div>
                        </div>

                        <div id="ddd-code" class="code-container" style="display: none;">
@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA

skinparam package {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
    FontSize 12
}

skinparam class {
    BackgroundColor #FFFFFF
    BorderColor #424242
    FontSize 10
}

package "Identity & Access Context" #LightBlue {
    
    class User <<Aggregate Root>> {
        -id: UserId
        -credentials: Credentials
        -profile: UserProfile
        -roles: List<Role>
        +authenticate(password: String): boolean
        +assignRole(role: Role): void
        +updateProfile(profile: UserProfile): void
    }
    
    class Credentials <<Value Object>> {
        -username: String
        -passwordHash: String
        -lastLogin: LocalDateTime
    }
    
    class UserProfile <<Entity>> {
        -firstName: String
        -lastName: String
        -email: Email
        -phoneNumber: String
    }
}

package "Catalog Context" #LightGreen {
    
    class Product <<Aggregate Root>> {
        -id: ProductId
        -name: String
        -description: String
        -price: Money
        -category: Category
        -availability: Availability
        +updatePrice(newPrice: Money): void
        +changeCategory(category: Category): void
        +updateAvailability(quantity: int): void
    }
    
    class Category <<Entity>> {
        -id: CategoryId
        -name: String
        -parentCategory: Category
        -subcategories: List<Category>
    }
    
    class Money <<Value Object>> {
        -amount: BigDecimal
        -currency: Currency
        +add(other: Money): Money
        +multiply(factor: BigDecimal): Money
    }
}

package "Order Context" #LightYellow {
    
    class Order <<Aggregate Root>> {
        -id: OrderId
        -customerId: CustomerId
        -orderItems: List<OrderItem>
        -status: OrderStatus
        -totalAmount: Money
        -orderDate: LocalDateTime
        +addItem(product: ProductId, quantity: int): void
        +removeItem(product: ProductId): void
        +confirm(): void
        +cancel(): void
        +ship(): void
    }
    
    class OrderItem <<Entity>> {
        -productId: ProductId
        -productName: String
        -quantity: int
        -unitPrice: Money
        -subtotal: Money
        +calculateSubtotal(): Money
    }
    
    enum OrderStatus {
        DRAFT
        CONFIRMED
        PAID
        SHIPPED
        DELIVERED
        CANCELLED
    }
}

package "Payment Context" #LightCoral {
    
    class Payment <<Aggregate Root>> {
        -id: PaymentId
        -orderId: OrderId
        -amount: Money
        -method: PaymentMethod
        -status: PaymentStatus
        -transactionId: String
        +process(): void
        +refund(amount: Money): void
        +verify(): boolean
    }
    
    class PaymentMethod <<Value Object>> {
        -type: PaymentType
        -details: Map<String, String>
    }
    
    enum PaymentStatus {
        PENDING
        PROCESSING
        COMPLETED
        FAILED
        REFUNDED
    }
}

package "Shipping Context" #LightPink {
    
    class Shipment <<Aggregate Root>> {
        -id: ShipmentId
        -orderId: OrderId
        -trackingNumber: String
        -carrier: Carrier
        -status: ShipmentStatus
        -estimatedDelivery: LocalDateTime
        +ship(): void
        +updateTracking(location: String): void
        +markAsDelivered(): void
    }
    
    class Carrier <<Entity>> {
        -id: CarrierId
        -name: String
        -trackingUrlTemplate: String
    }
}

' Context interactions via Domain Events
User ..> Order : CustomerRegistered
Product ..> Order : ProductOrdered
Order ..> Payment : OrderConfirmed
Payment ..> Shipment : PaymentCompleted

note top of "Identity & Access Context"
    User management
    Authentication
    Authorization
end note

note top of "Catalog Context"
    Product information
    Pricing
    Inventory
end note

note top of "Order Context"
    Order lifecycle
    Business rules
    Order validation
end note

note top of "Payment Context"
    Payment processing
    Financial transactions
    Refunds
end note

note top of "Shipping Context"
    Logistics
    Tracking
    Delivery management
end note

@enduml
                        </div>
                        <div id="ddd-diagram">Cargando diagrama...</div>
                    </div>
                </div>

                <div id="code-generation" class="phase-header">⚙️ Generación de Código y Testing</div>
                <div class="phase-content">
                    <h3>🔧 Herramientas de Generación de Código</h3>
                    
                    <h4>1. Enterprise Architect - Code Generation</h4>
                    <div class="description">
                        Enterprise Architect permite generar código directamente desde diagramas UML, manteniendo la sincronización entre modelo y código.
                    </div>

                    <div class="example">
                        <h5>📝 Ejemplo de Generación Java desde Diagrama de Clases</h5>
                        <div class="code-container">
<strong>Diagrama UML:</strong>
<code>
class BankAccount {
    -accountNumber: String
    -balance: BigDecimal
    -accountType: AccountType
    +deposit(amount: BigDecimal): void
    +withdraw(amount: BigDecimal): boolean
    +getBalance(): BigDecimal
}

enum AccountType {
    CHECKING
    SAVINGS
    BUSINESS
}
</code>

<strong>Código Java Generado:</strong>
<code>
public class BankAccount {
    private String accountNumber;
    private BigDecimal balance;
    private AccountType accountType;
    
    public BankAccount() {
        this.balance = BigDecimal.ZERO;
    }
    
    public void deposit(BigDecimal amount) {
        if (amount.compareTo(BigDecimal.ZERO) > 0) {
            this.balance = this.balance.add(amount);
        }
    }
    
    public boolean withdraw(BigDecimal amount) {
        if (amount.compareTo(BigDecimal.ZERO) > 0 
            && this.balance.compareTo(amount) >= 0) {
            this.balance = this.balance.subtract(amount);
            return true;
        }
        return false;
    }
    
    public BigDecimal getBalance() {
        return this.balance;
    }
    
    // Getters and setters
    public String getAccountNumber() { return accountNumber; }
    public void setAccountNumber(String accountNumber) { 
        this.accountNumber = accountNumber; 
    }
    
    public AccountType getAccountType() { return accountType; }
    public void setAccountType(AccountType accountType) { 
        this.accountType = accountType; 
    }
}

public enum AccountType {
    CHECKING,
    SAVINGS,
    BUSINESS
}
</code>
                        </div>
                    </div>

                    <h4>2. PlantUML y Herramientas de CI/CD</h4>
                    <div class="description">
                        Integración de PlantUML en pipelines de CI/CD para mantener documentación actualizada automáticamente.
                    </div>

                    <div class="example">
                        <h5>🔄 Pipeline GitHub Actions para Documentación</h5>
                        <div class="code-container">
<strong>Archivo .github/workflows/docs.yml:</strong>
<code>
name: Generate Documentation

on:
  push:
    paths:
      - 'docs/**/*.puml'
      - 'src/**/*.java'
  pull_request:
    paths:
      - 'docs/**/*.puml'

jobs:
  generate-diagrams:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Java
      uses: actions/setup-java@v3
      with:
        java-version: '11'
        distribution: 'temurin'
    
    - name: Install PlantUML
      run: |
        wget https://github.com/plantuml/plantuml/releases/download/v1.2023.12/plantuml-1.2023.12.jar
        sudo mv plantuml-1.2023.12.jar /opt/plantuml.jar
        echo 'alias plantuml="java -jar /opt/plantuml.jar"' >> ~/.bashrc
    
    - name: Generate SVG diagrams
      run: |
        find docs -name "*.puml" -exec java -jar /opt/plantuml.jar -tsvg {} \;
    
    - name: Generate PNG diagrams
      run: |
        find docs -name "*.puml" -exec java -jar /opt/plantuml.jar -tpng {} \;
    
    - name: Update documentation
      run: |
        # Script para actualizar README.md con enlaces a diagramas
        python scripts/update_docs.py
    
    - name: Commit generated files
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add docs/generated/
        git commit -m "Auto-update documentation diagrams" || exit 0
        git push
</code>
                        </div>
                    </div>

                    <h3>🧪 Testing y Validación de Modelos</h3>
                    
                    <h4>1. Validación de Consistencia de Modelos</h4>
                    <div class="description">
                        Herramientas automatizadas para verificar la consistencia entre diferentes diagramas UML y detectar inconsistencias de modelado.
                    </div>

                    <div class="example">
                        <h5>✅ Ejemplo de Validaciones Automatizadas</h5>
                        <div class="code-container">
<strong>Script Python para Validación de Modelos:</strong>
<code>
import re
from pathlib import Path

class UMLModelValidator:
    def __init__(self, model_path):
        self.model_path = Path(model_path)
        self.errors = []
        self.warnings = []
    
    def validate_class_diagram(self, file_path):
        """Valida consistencia en diagramas de clases"""
        content = file_path.read_text()
        
        # Verificar nomenclatura de clases
        classes = re.findall(r'class\s+(\w+)', content)
        for class_name in classes:
            if not class_name[0].isupper():
                self.errors.append(
                    f"Clase '{class_name}' debe comenzar con mayúscula"
                )
        
        # Verificar métodos privados
        private_methods = re.findall(r'-\s*(\w+)\s*\(', content)
        for method in private_methods:
            if not method.startswith('_'):
                self.warnings.append(
                    f"Método privado '{method}' debería comenzar con '_'"
                )
    
    def validate_sequence_diagram(self, file_path):
        """Valida diagramas de secuencia"""
        content = file_path.read_text()
        
        # Verificar que todos los participantes estén definidos
        participants = re.findall(r'participant\s+"([^"]+)"', content)
        activations = re.findall(r'(\w+)\s*->', content)
        
        for activation in activations:
            if activation not in [p.replace(' ', '') for p in participants]:
                self.errors.append(
                    f"Participante '{activation}' no está definido"
                )
    
    def validate_all_models(self):
        """Ejecuta todas las validaciones"""
        puml_files = self.model_path.glob('**/*.puml')
        
        for file_path in puml_files:
            content = file_path.read_text()
            
            if 'class ' in content:
                self.validate_class_diagram(file_path)
            elif 'participant' in content or '->' in content:
                self.validate_sequence_diagram(file_path)
        
        return self.generate_report()
    
    def generate_report(self):
        """Genera reporte de validación"""
        report = {
            'errors': self.errors,
            'warnings': self.warnings,
            'status': 'PASSED' if not self.errors else 'FAILED'
        }
        return report

# Uso en pipeline de CI/CD
if __name__ == "__main__":
    validator = UMLModelValidator('./docs/uml')
    report = validator.validate_all_models()
    
    print(f"Validation Status: {report['status']}")
    
    if report['errors']:
        print("ERRORS:")
        for error in report['errors']:
            print(f"  ❌ {error}")
    
    if report['warnings']:
        print("WARNINGS:")
        for warning in report['warnings']:
            print(f"  ⚠️ {warning}")
    
    # Salir con código de error si hay errores
    exit(1 if report['errors'] else 0)
</code>
                        </div>
                    </div>

                    <h4>2. Testing de Arquitectura con ArchUnit</h4>
                    <div class="description">
                        ArchUnit permite validar que el código siga las reglas arquitectónicas definidas en los modelos UML.
                    </div>

                    <div class="example">
                        <h5>🏗️ Tests de Arquitectura Hexagonal</h5>
                        <div class="code-container">
<strong>Test Java con ArchUnit:</strong>
<code>
import com.tngtech.archunit.junit.AnalyzeClasses;
import com.tngtech.archunit.junit.ArchTest;
import com.tngtech.archunit.lang.ArchRule;

import static com.tngtech.archunit.lang.syntax.ArchRuleDefinition.*;
import static com.tngtech.archunit.library.Architectures.layeredArchitecture;

@AnalyzeClasses(packages = "com.example")
public class HexagonalArchitectureTest {

    @ArchTest
    static final ArchRule domain_should_not_depend_on_infrastructure = 
        noClasses()
            .that().resideInAPackage("..domain..")
            .should().dependOnClassesThat()
            .resideInAnyPackage("..infrastructure..");

    @ArchTest
    static final ArchRule domain_should_not_depend_on_application = 
        noClasses()
            .that().resideInAPackage("..domain..")
            .should().dependOnClassesThat()
            .resideInAnyPackage("..application..");

    @ArchTest
    static final ArchRule infrastructure_should_not_depend_on_application = 
        noClasses()
            .that().resideInAPackage("..infrastructure..")
            .should().dependOnClassesThat()
            .resideInAnyPackage("..application..");

    @ArchTest
    static final ArchRule layered_architecture_is_respected = 
        layeredArchitecture()
            .layer("Controller").definedBy("..infrastructure.web..")
            .layer("Application").definedBy("..application..")
            .layer("Domain").definedBy("..domain..")
            .layer("Infrastructure").definedBy("..infrastructure..")
            
            .whereLayer("Controller").mayNotBeAccessedByAnyLayer()
            .whereLayer("Application").mayOnlyBeAccessedByLayers("Controller")
            .whereLayer("Domain").mayOnlyBeAccessedByLayers("Application", "Infrastructure")
            .whereLayer("Infrastructure").mayNotAccessAnyLayer();

    @ArchTest
    static final ArchRule repositories_should_be_interfaces = 
        classes()
            .that().haveNameMatching(".*Repository")
            .should().beInterfaces();

    @ArchTest
    static final ArchRule services_should_be_in_application_layer = 
        classes()
            .that().haveNameMatching(".*Service")
            .should().resideInAPackage("..application..");

    @ArchTest
    static final ArchRule entities_should_be_in_domain_layer = 
        classes()
            .that().areAnnotatedWith(Entity.class)
            .should().resideInAPackage("..domain..");

    @ArchTest
    static final ArchRule value_objects_should_be_immutable = 
        classes()
            .that().areAnnotatedWith(ValueObject.class)
            .should().haveOnlyFinalFields();
}
</code>
                        </div>
                    </div>
                </div>

                <div id="methodology-section" class="phase-header">📋 Metodología RUP en el Contexto Moderno</div>
                <div class="phase-content">
                    <h3>🎯 Adaptación de RUP a Metodologías Ágiles</h3>
                    
                    <h4>RUP + Scrum: Un Enfoque Híbrido</h4>
                    <div class="description">
                        La combinación de la estructura de RUP con la agilidad de Scrum permite obtener lo mejor de ambos mundos: documentación controlada y entrega iterativa rápida.
                    </div>

                    <div class="rup-phase">
                        <h5>🔄 Sprint Planning con Artefactos RUP</h5>
                        <ul>
                            <li><strong>Inicio del Sprint:</strong> Revisión de casos de uso y arquitectura</li>
                            <li><strong>Planning Poker:</strong> Estimación basada en complejidad de diagramas UML</li>
                            <li><strong>Definition of Done:</strong> Incluye actualización de modelos UML</li>
                            <li><strong>Sprint Review:</strong> Demostración con diagramas de secuencia</li>
                        </ul>
                    </div>

                    <h3>🏗️ Escalabilidad y Gestión de Proyectos Grandes</h3>
                    
                    <h4>Organización por Bounded Contexts</h4>
                    <div class="description">
                        En proyectos grandes, RUP se beneficia de la organización por contextos delimitados, donde cada equipo maneja un dominio específico con sus propios modelos UML.
                    </div>

                    <div class="rup-phase">
                        <h5>👥 Estructura de Equipos</h5>
                        <ul>
                            <li><strong>Equipo de Arquitectura:</strong> Define modelos de alto nivel y patrones</li>
                            <li><strong>Equipos de Dominio:</strong> Implementan bounded contexts específicos</li>
                            <li><strong>Equipo de Integración:</strong> Gestiona comunicación entre contextos</li>
                            <li><strong>Equipo de Platform:</strong> Mantiene infraestructura común</li>
                        </ul>
                    </div>

                    <h3>🔄 Trazabilidad Desde Requisitos Hasta Código</h3>
                    
                    <h4>Matriz de Trazabilidad con Herramientas Modernas</h4>
                    <div class="description">
                        La trazabilidad efectiva vincula requisitos, casos de uso, diagramas UML y código fuente, facilitando el análisis de impacto y la gestión de cambios.
                    </div>

                    <div class="example">
                        <h5>📊 Ejemplo de Trazabilidad</h5>
                        <div class="code-container">
<strong>Flujo de Trazabilidad:</strong>
<code>
Requisito REQ-001: "El sistema debe permitir autenticación de usuarios"
    ↓
Caso de Uso UC-001: "Autenticar Usuario"
    ↓  
Diagrama de Secuencia: authentication-sequence.puml
    ↓
Clases de Implementación:
    - UserService.java
    - AuthenticationController.java
    - UserRepository.java
    ↓
Tests:
    - UserServiceTest.java
    - AuthenticationIntegrationTest.java
</code>

<strong>Herramientas de Trazabilidad:</strong>
<code>
Jira + Confluence:
- REQ-001 enlazado con UC-001
- UC-001 enlazado con diagramas en Confluence
- Código enlazado via commits: "feat: implement UC-001"

GitLab/GitHub:
- Issues: REQ-001, UC-001
- Merge Requests: Referencias automáticas
- Pipeline CI/CD: Validación de modelos UML
</code>
                        </div>
                    </div>

                    <h3>⚡ Gestión de Riesgos en Desarrollo Moderno</h3>
                    
                    <h4>Identificación Temprana con Arquitectura</h4>
                    <div class="description">
                        Los diagramas UML ayudan a identificar riesgos arquitectónicos tempranamente, especialmente en sistemas distribuidos y microservicios.
                    </div>

                    <div class="rup-phase">
                        <h5>🚨 Riesgos Comunes y Mitigación</h5>
                        <ul>
                            <li><strong>Acoplamiento Alto:</strong> Detectado en diagramas de clases → Refactoring a interfaces</li>
                            <li><strong>Dependencias Circulares:</strong> Visibles en diagramas de paquetes → Reestructuración de módulos</li>
                            <li><strong>Bottlenecks de Performance:</strong> Identificados en diagramas de secuencia → Optimización de interacciones</li>
                            <li><strong>Complejidad de Estados:</strong> Evidentes en diagramas de estados → Simplificación de flujos</li>
                        </ul>
                    </div>
                </div>

                <div id="conclusions-section" class="phase-header">🎓 Conclusiones y Mejores Prácticas</div>
                <div class="phase-content">
                    <h3>🏆 Relevancia de RUP en el Desarrollo Moderno</h3>
                    
                    <div class="description">
                        RUP mantiene su relevancia en el desarrollo moderno de software gracias a su capacidad de adaptación y su enfoque estructurado. Su combinación con prácticas ágiles, herramientas modernas y arquitecturas contemporáneas lo convierte en una opción viable para proyectos que requieren:
                    </div>

                    <div class="rup-phase">
                        <h4>✅ Fortalezas de RUP Moderno</h4>
                        <ul>
                            <li><strong>Documentación y Trazabilidad Rigurosas:</strong> Esencial para proyectos críticos y regulados</li>
                            <li><strong>Gestión Efectiva de Riesgos:</strong> Identificación temprana de problemas arquitectónicos</li>
                            <li><strong>Desarrollo Iterativo Controlado:</strong> Balance entre agilidad y control</li>
                            <li><strong>Arquitecturas Sólidas y Escalables:</strong> Base sólida para sistemas complejos</li>
                            <li><strong>Facilita Onboarding:</strong> Nuevos desarrolladores comprenden rápidamente el sistema</li>
                        </ul>
                    </div>

                    <h3>🎯 Recomendaciones de Implementación</h3>
                    
                    <h4>1. Cuándo Usar RUP</h4>
                    <div class="rup-phase">
                        <strong>✅ Ideal para:</strong>
                        <ul>
                            <li>Proyectos empresariales grandes (>50 desarrolladores)</li>
                            <li>Sistemas críticos con requisitos de trazabilidad</li>
                            <li>Arquitecturas complejas (microservicios, sistemas distribuidos)</li>
                            <li>Proyectos con equipos distribuidos geográficamente</li>
                            <li>Dominios regulados (financiero, salud, aeroespacial)</li>
                        </ul>
                        
                        <strong>❌ No recomendado para:</strong>
                        <ul>
                            <li>Proyectos pequeños (<5 desarrolladores)</li>
                            <li>Startups con requisitos muy cambiantes</li>
                            <li>Prototipos o MVPs rápidos</li>
                            <li>Equipos sin experiencia en modelado UML</li>
                        </ul>
                    </div>

                    <h4>2. Adaptación Gradual</h4>
                    <div class="rup-phase">
                        <strong>🚀 Roadmap de Adopción:</strong>
                        <ol>
                            <li><strong>Fase 1 (1-2 meses):</strong> Introducir diagramas de casos de uso y clases principales</li>
                            <li><strong>Fase 2 (2-3 meses):</strong> Agregar diagramas de secuencia para flujos críticos</li>
                            <li><strong>Fase 3 (3-4 meses):</strong> Implementar diagramas de componentes y despliegue</li>
                            <li><strong>Fase 4 (4-6 meses):</strong> Establecer proceso completo con herramientas de generación</li>
                        </ol>
                    </div>

                    <h3>🛠️ Stack Tecnológico Recomendado</h3>
                    
                    <div class="rup-phase">
                        <h4>🎨 Herramientas de Modelado</h4>
                        <ul>
                            <li><strong>PlantUML:</strong> Diagramas como código, integración con Git</li>
                            <li><strong>Enterprise Architect:</strong> Modelado completo y generación de código</li>
                            <li><strong>Visual Paradigm:</strong> Colaboración en tiempo real</li>
                            <li><strong>Draw.io:</strong> Diagramas rápidos y colaborativos</li>
                        </ul>
                        
                        <h4>📚 Gestión de Documentación</h4>
                        <ul>
                            <li><strong>Confluence:</strong> Wiki empresarial con diagramas embebidos</li>
                            <li><strong>GitBook:</strong> Documentación moderna con Git</li>
                            <li><strong>Notion:</strong> Workspace all-in-one para equipos pequeños</li>
                            <li><strong>GitHub/GitLab Wikis:</strong> Documentación junto al código</li>
                        </ul>
                        
                        <h4>🔄 CI/CD y Automatización</h4>
                        <ul>
                            <li><strong>GitHub Actions:</strong> Generación automática de diagramas</li>
                            <li><strong>Jenkins:</strong> Pipelines de validación de modelos</li>
                            <li><strong>SonarQube:</strong> Análisis de calidad con reglas arquitectónicas</li>
                            <li><strong>ArchUnit:</strong> Testing de arquitectura automatizado</li>
                        </ul>
                    </div>

                    <h3>📈 Métricas de Éxito</h3>
                    
                    <div class="rup-phase">
                        <h4>🎯 KPIs para Evaluar la Efectividad de RUP</h4>
                        <ul>
                            <li><strong>Time to Onboard:</strong> Tiempo para que nuevos desarrolladores sean productivos</li>
                            <li><strong>Defect Density:</strong> Defectos por línea de código (debería disminuir)</li>
                            <li><strong>Architecture Debt:</strong> Métricas de acoplamiento y complejidad ciclomática</li>
                            <li><strong>Documentation Coverage:</strong> % de código con diagramas UML actualizados</li>
                            <li><strong>Requirements Traceability:</strong> % de requisitos trazables al código</li>
                            <li><strong>Change Impact Analysis Time:</strong> Tiempo para analizar impacto de cambios</li>
                        </ul>
                    </div>

                    <h3>🔮 Futuro de RUP</h3>
                    
                    <div class="description">
                        El futuro de RUP está en su evolución hacia metodologías híbridas que combinen:
                    </div>

                    <div class="rup-phase">
                        <h4>🚀 Tendencias Emergentes</h4>
                        <ul>
                            <li><strong>AI-Assisted Modeling:</strong> IA para generar diagramas desde código</li>
                            <li><strong>Real-time Collaboration:</strong> Modelado colaborativo en tiempo real</li>
                            <li><strong>Model-Driven DevOps:</strong> Infraestructura como código desde modelos UML</li>
                            <li><strong>Continuous Architecture:</strong> Evolución arquitectónica continua</li>
                            <li><strong>Domain-Specific Languages:</strong> UML extendido para dominios específicos</li>
                        </ul>
                    </div>

                    <div class="info" style="margin-top: 40px; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px;">
                        <h4 style="color: white; margin-top: 0;">🎯 Mensaje Final</h4>
                        <p style="margin-bottom: 0; font-size: 16px; line-height: 1.6;">
                            <strong>RUP no es solo una metodología del pasado, sino una base sólida para el futuro del desarrollo de software.</strong> 
                            Su capacidad de adaptación, combinada con herramientas modernas como PlantUML y prácticas DevOps, 
                            lo convierte en una opción poderosa para proyectos que requieren tanto agilidad como rigor arquitectónico.
                            <br><br>
                            <em>La clave del éxito está en adaptar RUP a las necesidades específicas de tu proyecto y equipo, 
                            no en seguir dogmáticamente cada proceso.</em>
                        </p>
                    </div>
                </div>

                <div class="info" style="margin-top: 40px;">
                    <strong>📚 Referencias y Recursos Adicionales:</strong>
                    <ul>
                        <li><strong>OMG UML Specification:</strong> <a href="https://www.omg.org/spec/UML/" target="_blank" rel="noopener">https://www.omg.org/spec/UML/</a></li>
                        <li><strong>PlantUML Documentation:</strong> <a href="https://plantuml.com/" target="_blank" rel="noopener">https://plantuml.com/</a></li>
                        <li><strong>Visual Paradigm UML Tutorials:</strong> <a href="https://www.visual-paradigm.com/guide/uml-unified-modeling-language/what-is-uml/" target="_blank" rel="noopener">Visual Paradigm UML Guide</a></li>
                        <li><strong>Domain-Driven Design:</strong> <a href="https://martinfowler.com/bliki/DomainDrivenDesign.html" target="_blank" rel="noopener">Martin Fowler on DDD</a></li>
                        <li><strong>Enterprise Architect:</strong> <a href="https://sparxsystems.com/" target="_blank" rel="noopener">https://sparxsystems.com/</a></li>
                        <li><strong>ArchUnit Testing:</strong> <a href="https://www.archunit.org/" target="_blank" rel="noopener">https://www.archunit.org/</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Sección de Herramientas -->
        <div id="tools-section" class="content-section">
            <h1>🔧 Herramientas y Recursos para RUP</h1>
            
            <div class="theory-section">
                <h2>🛠️ Herramientas Modernas para RUP</h2>
                
                <div class="rup-phase">
                    <h4>📐 Herramientas de Modelado</h4>
                    <ul>
                        <li><strong>Enterprise Architect:</strong> Modelado UML completo</li>
                        <li><strong>IBM Rational Software Architect:</strong> Herramienta integrada de IBM</li>
                        <li><strong>Visual Paradigm:</strong> Herramienta de modelado colaborativa</li>
                        <li><strong>PlantUML:</strong> Diagramas como código (usado en este manual)</li>
                    </ul>
                </div>

                <div class="rup-phase">
                    <h4>💻 Herramientas de Desarrollo</h4>
                    <ul>
                        <li><strong>IDEs:</strong> IntelliJ IDEA, Eclipse, Visual Studio Code</li>
                        <li><strong>Control de Versiones:</strong> Git con GitHub/GitLab/Bitbucket</li>
                        <li><strong>CI/CD:</strong> Jenkins, Azure DevOps, GitHub Actions</li>
                        <li><strong>Testing:</strong> JUnit, TestNG, Selenium, Postman</li>
                    </ul>
                </div>

                <div class="rup-phase">
                    <h4>📊 Herramientas de Gestión</h4>
                    <ul>
                        <li><strong>Jira:</strong> Gestión de proyectos y seguimiento de issues</li>
                        <li><strong>Confluence:</strong> Documentación colaborativa</li>
                        <li><strong>Trello:</strong> Gestión visual de tareas</li>
                        <li><strong>Slack/Teams:</strong> Comunicación del equipo</li>
                    </ul>
                </div>

                <h2>📋 Instrucciones para Usar PlantUML Localmente</h2>
                
                <div class="rup-phase">
                    <h4>🔧 Opción 1: PlantUML con Java</h4>
                    <ol>
                        <li><strong>Descargar PlantUML:</strong> Obtén el archivo <code>plantuml.jar</code> desde <a href="https://plantuml.com/download" target="_blank">plantuml.com</a></li>
                        <li><strong>Instalar Java:</strong> Asegúrate de tener Java 8+ instalado</li>
                        <li><strong>Usar desde línea de comandos:</strong>
                            <div class="code-container">java -jar plantuml.jar diagram.puml</div>
                        </li>
                    </ol>
                </div>

                <div class="rup-phase">
                    <h4>📝 Opción 2: Extensiones de VSCode</h4>
                    <ol>
                        <li><strong>PlantUML:</strong> Extensión oficial para VSCode</li>
                        <li><strong>PlantUML Preview:</strong> Vista previa en tiempo real</li>
                        <li><strong>Configuración:</strong> Añade la ruta de PlantUML en settings.json</li>
                    </ol>
                </div>

                <div class="rup-phase">
                    <h4>🌐 Opción 3: Herramientas Online</h4>
                    <ul>
                        <li><strong>PlantText.com:</strong> Editor online sin instalación</li>
                        <li><strong>PlantUML.com:</strong> Servidor oficial</li>
                        <li><strong>Kroki.io:</strong> Servicio de diagramas como código</li>
                    </ul>
                </div>

                <h2>📤 Exportar Diagramas</h2>
                <div class="code-container">
                    <code>
# SVG (Recomendado para calidad)<BR>
java -jar plantuml.jar -tsvg diagram.puml<BR><BR>

# PNG (Para documentos)<BR>
java -jar plantuml.jar -tpng diagram.puml<BR><BR>

# PDF (Para presentaciones)<BR>
java -jar plantuml.jar -tpdf diagram.puml<BR><BR>
                    </code>
                </div>

                <h2>✅ Mejores Prácticas</h2>
                <div class="rup-phase">
                    <ul>
                        <li><strong>Organización:</strong> Mantén cada diagrama en archivos separados</li>
                        <li><strong>Versionado:</strong> Usa Git para controlar versiones de los diagramas</li>
                        <li><strong>Nomenclatura:</strong> Usa nombres descriptivos (<code>use-case-biblioteca.puml</code>)</li>
                        <li><strong>Temas:</strong> Aplica temas consistentes (<code>!theme cerulean-outline</code>)</li>
                        <li><strong>Documentación:</strong> Incluye comentarios explicativos en el código PlantUML</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Función para mostrar secciones
        function showSection(sectionName, event) {
            // Ocultar todas las secciones
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remover clase active de todos los botones
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Mostrar la sección seleccionada
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.classList.add('active');
            } else {
                console.error(`Sección ${sectionName}-section no encontrada`);
                return;
            }
            
            // Activar el botón correspondiente si existe el evento
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                // Si no hay evento, buscar el botón por el texto
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    if ((sectionName === 'theory' && btn.textContent.includes('Teoría')) ||
                        (sectionName === 'example' && btn.textContent.includes('Ejemplo')) ||
                        (sectionName === 'uml-manual' && btn.textContent.includes('Manual de UML')) ||
                        (sectionName === 'tools' && btn.textContent.includes('Herramientas'))) {
                        btn.classList.add('active');
                    }
                });
            }
        }

        // Función para alternar teoría
        function toggleTheory() {
            const theoryContent = document.getElementById('theory-content');
            const button = event.target;
            
            if (theoryContent.style.display === 'none' || theoryContent.style.display === '') {
                theoryContent.style.display = 'block';
                button.textContent = '📚 Ocultar Fundamentos de RUP';
            } else {
                theoryContent.style.display = 'none';
                button.textContent = '📚 Ver Fundamentos de RUP';
            }
        }

        // Función para alternar visibilidad del código
        function toggleCode(elementId) {
            const element = document.getElementById(elementId);
            if (element.style.display === 'none' || element.style.display === '') {
                element.style.display = 'block';
            } else {
                element.style.display = 'none';
            }
        }

        // Función para copiar código al portapapeles
        function copyCode(codeElementId) {
            const codeElement = document.getElementById(codeElementId);
            const code = codeElement.textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                // Mostrar feedback visual
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '✅ ¡Copiado!';
                button.style.background = '#27ae60';
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '';
                }, 2000);
            }).catch(err => {
                // Fallback para navegadores más antiguos
                const textArea = document.createElement('textarea');
                textArea.value = code;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Código copiado al portapapeles!');
            });
        }

        // Funciones para exportación de diagramas
        function exportDiagram(diagramId, format, filename) {
            const diagramContainer = document.getElementById(diagramId);
            if (!diagramContainer) {
                alert('❌ Error: No se encontró el diagrama');
                return;
            }

            const img = diagramContainer.querySelector('img');
            if (!img) {
                alert('❌ Error: El diagrama no está cargado aún');
                return;
            }

            try {
                // Obtener la URL del diagrama y cambiar el formato si es necesario
                let imageUrl = img.src;
                
                // Cambiar formato en la URL si es SVG
                if (format === 'svg') {
                    imageUrl = imageUrl.replace('/png/', '/svg/');
                }

                // Crear elemento de descarga temporal
                const link = document.createElement('a');
                link.href = imageUrl;
                link.download = `${filename}.${format}`;
                
                // Agregar timestamp para evitar conflictos
                const timestamp = new Date().getTime();
                link.download = `${filename}-${timestamp}.${format}`;

                // Ejecutar descarga
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                // Mostrar confirmación
                setTimeout(() => {
                    alert(`✅ Diagrama exportado como ${filename}-${timestamp}.${format}`);
                }, 100);

            } catch (error) {
                console.error('Error exportando diagrama:', error);
                alert('❌ Error al exportar. Intente hacer clic derecho en el diagrama y "Guardar imagen como..."');
            }
        }

        function openInPlantText(codeElementId) {
            const codeElement = document.getElementById(codeElementId);
            if (!codeElement) {
                alert('❌ Error: No se encontró el código del diagrama');
                return;
            }

            const code = codeElement.textContent || codeElement.innerText;
            
            try {
                // Codificar el código para URL
                const encodedCode = encodeURIComponent(code);
                const plantTextUrl = `https://www.planttext.com/?text=${encodedCode}`;
                
                // Abrir en nueva pestaña
                window.open(plantTextUrl, '_blank');
            } catch (error) {
                console.error('Error abriendo PlantText:', error);
                // Fallback: solo abrir PlantText
                window.open('https://www.planttext.com/', '_blank');
                alert('💡 Código copiado al portapapeles. Pégalo en PlantText.com');
                
                // Copiar código como fallback
                navigator.clipboard.writeText(code).catch(() => {
                    console.log('No se pudo copiar automáticamente');
                });
            }
        }

        // Función para agregar botones de exportación automáticamente
        function addExportButtons() {
            // Lista de todos los diagramas y sus nombres
            const diagrams = [
                {code: 'activity-code', container: 'activity-diagram', name: 'diagrama-actividad'},
                {code: 'state-code', container: 'state-diagram', name: 'diagrama-estados'},
                {code: 'component-code', container: 'component-diagram', name: 'diagrama-componentes'},
                {code: 'deployment-code', container: 'deployment-diagram', name: 'diagrama-despliegue'},
                {code: 'collaboration-code', container: 'collaboration-diagram', name: 'diagrama-colaboracion'},
                // Diagramas del Manual de UML (los que no tienen botones de exportación ya)
                {code: 'package-code', container: 'package-diagram', name: 'diagrama-paquetes'},
                {code: 'detailed-usecase-code', container: 'detailed-usecase-diagram', name: 'diagrama-casos-uso-detallado'}
            ];

            diagrams.forEach(diagram => {
                // Buscar el botón de copiar código
                const copyButton = document.querySelector(`[onclick="copyCode('${diagram.code}')"]`);
                if (copyButton && !copyButton.nextElementSibling?.classList?.contains('export-dropdown')) {
                    // Crear el dropdown
                    const dropdown = document.createElement('div');
                    dropdown.className = 'export-dropdown';
                    dropdown.innerHTML = `
                        <button class="export-btn">📥 Exportar ▼</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="exportDiagram('${diagram.container}', 'png', '${diagram.name}'); return false;">📥 Descargar PNG</a>
                            <a href="#" onclick="exportDiagram('${diagram.container}', 'svg', '${diagram.name}'); return false;">📄 Descargar SVG</a>
                            <a href="#" onclick="openInPlantText('${diagram.code}'); return false;">🌐 Abrir en PlantText</a>
                        </div>
                    `;
                    
                    // Insertar después del botón de copiar
                    copyButton.parentNode.insertBefore(dropdown, copyButton.nextSibling);
                }
            });
        }

        // Función para generar diagramas PlantUML
        function generateDiagram(plantUMLCode, containerId) {
            const container = document.getElementById(containerId);
            
            if (!container) {
                console.error(`Contenedor ${containerId} no encontrado`);
                return;
            }

            try {
                // Limpiar código de caracteres problemáticos
                const cleanCode = plantUMLCode.trim();
                console.log(`Generando diagrama para ${containerId}:`, cleanCode.substring(0, 100) + '...');
                
                // Verificar que plantumlEncoder esté disponible
                if (typeof plantumlEncoder === 'undefined') {
                    container.innerHTML = 
                        '<div class="error">❌ Error: No se pudo cargar el encoder de PlantUML. <br><a href="https://www.planttext.com/" target="_blank">Usar PlantText.com como alternativa</a></div>';
                    return;
                }

                const encoded = plantumlEncoder.encode(cleanCode);
                console.log(`Código encodificado para ${containerId}:`, encoded.substring(0, 50) + '...');
                
                // Crear múltiples opciones de servidor
                const servers = [
                    'https://www.plantuml.com/plantuml/svg/',
                    'https://plantuml-server.kkeisuke.com/svg/',
                    'http://www.plantuml.com/plantuml/svg/'
                ];
                
                let serverIndex = 0;
                
                function tryNextServer() {
                    if (serverIndex >= servers.length) {
                        container.innerHTML = `
                            <div class="error">
                                ❌ No se pudo cargar el diagrama desde ningún servidor PlantUML. 
                                <br><strong>Alternativas:</strong>
                                <ul>
                                    <li><button onclick="copyCodeToClipboard('${containerId}', \`${cleanCode.replace(/`/g, '\\`')}\`)">📋 Copiar código PlantUML</button></li>
                                    <li><a href="https://www.planttext.com/" target="_blank">Abrir en PlantText.com</a></li>
                                    <li><a href="https://plantuml.com/es/starting" target="_blank">Usar PlantUML Local</a></li>
                                </ul>
                            </div>`;
                        return;
                    }
                    
                    const img = document.createElement('img');
                    const currentServer = servers[serverIndex];
                    img.src = currentServer + encoded;
                    img.alt = 'Diagrama UML';
                    img.style.maxWidth = '100%';
                    img.style.height = 'auto';
                    
                    console.log(`Intentando servidor ${serverIndex + 1}: ${currentServer}`);
                    
                    img.onload = function() {
                        console.log(`✅ Diagrama ${containerId} cargado exitosamente desde ${currentServer}`);
                        container.innerHTML = '';
                        container.appendChild(img);
                    };
                    
                    img.onerror = function() {
                        console.warn(`❌ Error cargando desde ${currentServer}, intentando siguiente...`);
                        serverIndex++;
                        tryNextServer();
                    };
                    
                    // Timeout por servidor individual
                    setTimeout(() => {
                        if (container.innerHTML.includes('Cargando diagrama...')) {
                            console.warn(`⏱️ Timeout para servidor ${currentServer}`);
                            serverIndex++;
                            tryNextServer();
                        }
                    }, 10000); // 10 segundos por servidor
                }
                
                tryNextServer();
                
            } catch (error) {
                console.error(`Error procesando diagrama ${containerId}:`, error);
                container.innerHTML = `
                    <div class="error">
                        ❌ Error al procesar el código PlantUML: ${error.message}
                        <br><button onclick="copyCodeToClipboard('${containerId}', \`${plantUMLCode.replace(/`/g, '\\`')}\`)">📋 Copiar código para uso local</button>
                    </div>`;
            }
        }

        // Función auxiliar para copiar código al portapapeles
        function copyCodeToClipboard(containerId, code) {
            navigator.clipboard.writeText(code).then(() => {
                alert('✅ Código PlantUML copiado al portapapeles!\nPuedes pegarlo en https://www.planttext.com/');
            }).catch(err => {
                console.error('Error copiando al portapapeles:', err);
                prompt('Copia este código PlantUML:', code);
            });
        }

        // Cargar todos los diagramas cuando la página esté lista
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Inicializando Manual RUP...');
            
            // Mostrar la sección de teoría por defecto
            showSection('theory');
            
            // Agregar botones de exportación a todos los diagramas
            setTimeout(() => {
                addExportButtons();
                console.log('📥 Botones de exportación agregados');
            }, 1000);
            
            // Agregar navegación con teclado
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case '1':
                            e.preventDefault();
                            showSection('theory');
                            break;
                        case '2':
                            e.preventDefault();
                            showSection('example');
                            break;
                        case '3':
                            e.preventDefault();
                            showSection('uml-manual');
                            break;
                        case '4':
                            e.preventDefault();
                            showSection('tools');
                            break;
                    }
                }
            });
            
            // Verificar si plantumlEncoder está disponible
            if (typeof plantumlEncoder === 'undefined') {
                console.error('❌ PlantUML Encoder no está disponible. Verificando CDN...');
                
                // Intentar cargar PlantUML encoder como fallback
                const script = document.createElement('script');
                script.src = 'https://unpkg.com/plantuml-encoder@1.4.0/dist/plantuml-encoder.min.js';
                script.onload = function() {
                    console.log('✅ PlantUML Encoder cargado como fallback');
                    initializeDiagrams();
                };
                script.onerror = function() {
                    console.error('❌ No se pudo cargar PlantUML Encoder');
                    showOfflineMessage();
                };
                document.head.appendChild(script);
                return;
            }
            
            console.log('✅ PlantUML Encoder disponible');
            initializeDiagrams();
        });

        function showOfflineMessage() {
            const diagramContainers = document.querySelectorAll('[id$="-diagram"]');
            diagramContainers.forEach(container => {
                container.innerHTML = `
                    <div class="error">
                        ❌ No se pudo cargar el encoder de PlantUML
                        <br><strong>Modo Offline:</strong>
                        <br><button onclick="copyAllCodes()">📋 Copiar todos los códigos PlantUML</button>
                        <br><a href="https://www.planttext.com/" target="_blank">Usar PlantText.com</a>
                    </div>`;
            });
        }

        function initializeDiagrams() {
            console.log('🎨 Inicializando generación de diagramas...');

            // Diagrama de Casos de Uso
            const usecaseCode = `@startuml
!theme cerulean-outline
skinparam backgroundColor #F8F9FA
skinparam actor {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
    FontSize 12
}
skinparam usecase {
    BackgroundColor #FFF3E0
    BorderColor #F57C00
    FontSize 11
}
skinparam package {
    BackgroundColor #E8F5E8
    BorderColor #4CAF50
}

left to right direction

actor "👤 Usuario/Estudiante" as Usuario
actor "👨‍💼 Bibliotecario" as Bibliotecario  
actor "🔧 Administrador" as Admin
actor "🔐 Sistema de\\nAutenticación" as SistAuth

package "Sistema de Gestión de Biblioteca" {
    usecase "🔍 Buscar Libros" as UC1
    usecase "📝 Solicitar Préstamo" as UC2
    usecase "✅ Registrar Préstamo" as UC3
    usecase "↩️ Procesar Devolución" as UC4
    usecase "📚 Gestionar Inventario" as UC5
    usecase "📊 Generar Reportes" as UC6
    usecase "🔑 Validar Usuario" as UC7
    usecase "📋 Consultar Historial" as UC8
    usecase "⚙️ Configurar Sistema" as UC9
}

Usuario --> UC1
Usuario --> UC2
Usuario --> UC8

Bibliotecario --> UC3
Bibliotecario --> UC4
Bibliotecario --> UC5

Admin --> UC6
Admin --> UC9

UC3 ..> UC7 : <<include>>
UC4 ..> UC7 : <<include>>
UC2 ..> UC7 : <<include>>

SistAuth --> UC7

note right of UC3 : "Requiere validación\\nde usuario y\\ndisponibilidad del libro"
note bottom of UC6 : "Incluye reportes de:\\n• Préstamos por período\\n• Libros más solicitados\\n• Usuarios morosos"

@enduml`;

            console.log('📊 Generando diagrama de casos de uso...');
            generateDiagram(usecaseCode, 'usecase-diagram');

            // Cargar otros diagramas usando el código ya presente en el HTML
            const diagrams = [
                {code: 'class-code', container: 'class-diagram'},
                {code: 'sequence-code', container: 'sequence-diagram'},
                {code: 'activity-code', container: 'activity-diagram'},
                {code: 'state-code', container: 'state-diagram'},
                {code: 'component-code', container: 'component-diagram'},
                {code: 'deployment-code', container: 'deployment-diagram'},
                {code: 'detailed-usecase-code', container: 'detailed-usecase-diagram'},
                {code: 'collaboration-code', container: 'collaboration-diagram'},
                {code: 'package-code', container: 'package-diagram'},
                // Conceptos Fundamentales - Elementos Estructurales
                {code: 'structural-class-example', container: 'structural-class-diagram'},
                {code: 'structural-interface-example', container: 'structural-interface-diagram'},
                {code: 'structural-component-example', container: 'structural-component-diagram'},
                {code: 'structural-node-example', container: 'structural-node-diagram'},
                // Conceptos Fundamentales - Elementos de Comportamiento
                {code: 'behavior-interaction-example', container: 'behavior-interaction-diagram'},
                {code: 'behavior-state-example', container: 'behavior-state-diagram'},
                // Conceptos Fundamentales - Elementos de Agrupación
                {code: 'grouping-package-example', container: 'grouping-package-diagram'},
                // Conceptos Fundamentales - Elementos de Anotación
                {code: 'annotation-note-example', container: 'annotation-note-diagram'},
                // Relaciones UML
                {code: 'relation-dependency-example', container: 'relation-dependency-diagram'},
                {code: 'relation-association-example', container: 'relation-association-diagram'},
                {code: 'relation-generalization-example', container: 'relation-generalization-diagram'},
                {code: 'relation-realization-example', container: 'relation-realization-diagram'},
                // Diagramas del Manual de UML - Estructura
                {code: 'uml-class-example', container: 'uml-class-diagram'},
                {code: 'uml-object-example', container: 'uml-object-diagram'},
                {code: 'uml-component-example', container: 'uml-component-diagram'},
                {code: 'uml-deployment-example', container: 'uml-deployment-diagram'},
                {code: 'uml-package-example', container: 'uml-package-diagram'},
                // Diagramas del Manual de UML - Comportamiento
                {code: 'uml-usecase-example', container: 'uml-usecase-diagram'},
                {code: 'uml-activity-example', container: 'uml-activity-diagram'},
                {code: 'uml-state-example', container: 'uml-state-diagram'},
                // Diagramas del Manual de UML - Interacción
                {code: 'uml-sequence-example', container: 'uml-sequence-diagram'},
                {code: 'uml-communication-example', container: 'uml-communication-diagram'},
                {code: 'uml-timing-example', container: 'uml-timing-diagram'},
                // Casos de Estudio
                {code: 'library-usecase-example', container: 'library-usecase-diagram'},
                {code: 'library-domain-example', container: 'library-domain-diagram'},
                {code: 'library-sequence-example', container: 'library-sequence-diagram'},
                {code: 'ecommerce-component-example', container: 'ecommerce-component-diagram'},
                // Patrones de Diseño
                {code: 'singleton-pattern', container: 'singleton-diagram'},
                {code: 'factory-pattern', container: 'factory-diagram'},
                {code: 'adapter-pattern', container: 'adapter-diagram'},
                {code: 'composite-pattern', container: 'composite-diagram'},
                {code: 'observer-pattern', container: 'observer-diagram'},
                {code: 'strategy-pattern', container: 'strategy-diagram'},
                // Técnicas Avanzadas
                {code: 'stereotype-code', container: 'stereotype-diagram'},
                {code: 'cqrs-code', container: 'cqrs-diagram'},
                {code: 'hexagonal-code', container: 'hexagonal-diagram'},
                {code: 'ddd-code', container: 'ddd-diagram'}
            ];

            console.log(`📈 Generando ${diagrams.length} diagramas adicionales...`);
            
            diagrams.forEach((diagram, index) => {
                const codeElement = document.getElementById(diagram.code);
                if (codeElement) {
                    console.log(`🔄 Procesando diagrama ${index + 1}/${diagrams.length}: ${diagram.container}`);
                    // Añadir delay para evitar sobrecarga
                    setTimeout(() => {
                        generateDiagram(codeElement.textContent, diagram.container);
                    }, index * 1000); // 1 segundo de delay entre diagramas
                } else {
                    console.warn(`⚠️ Elemento de código no encontrado: ${diagram.code}`);
                }
            });
            
            console.log('✅ Inicialización de diagramas completada');
        }

        // Función para copiar todos los códigos PlantUML
        function copyAllCodes() {
            const codes = document.querySelectorAll('.code-container');
            let allCodes = 'CÓDIGOS PLANTUML DEL MANUAL RUP\n' + '='.repeat(50) + '\n\n';
            
            codes.forEach((code, index) => {
                allCodes += `DIAGRAMA ${index + 1}:\n`;
                allCodes += code.textContent.trim() + '\n\n';
                allCodes += '-'.repeat(30) + '\n\n';
            });
            
            navigator.clipboard.writeText(allCodes).then(() => {
                alert('✅ Todos los códigos PlantUML copiados al portapapeles!');
            }).catch(err => {
                prompt('Copia todos estos códigos PlantUML:', allCodes);
            });
        }

        // Función para recargar un diagrama específico
        function reloadDiagram(containerId) {
            const container = document.getElementById(containerId);
            if (container) {
                container.innerHTML = '<div class="loading">🔄 Recargando diagrama...</div>';
                
                // Buscar el código correspondiente
                const codeId = containerId.replace('-diagram', '-code');
                const codeElement = document.getElementById(codeId);
                
                if (codeElement) {
                    setTimeout(() => {
                        generateDiagram(codeElement.textContent, containerId);
                    }, 500);
                } else if (containerId === 'usecase-diagram') {
                    // Para el diagrama de casos de uso que está hardcodeado
                    setTimeout(() => {
                        initializeDiagrams();
                    }, 500);
                }
            }
        }

        // Función para recargar todos los diagramas
        function reloadAllDiagrams() {
            console.log('🔄 Recargando todos los diagramas...');
            const containers = document.querySelectorAll('[id$="-diagram"]');
            containers.forEach(container => {
                container.innerHTML = '<div class="loading">🔄 Recargando diagrama...</div>';
            });
            
            setTimeout(() => {
                initializeDiagrams();
            }, 1000);
        }
    </script>
</body>
</html>